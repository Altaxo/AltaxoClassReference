<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"> </script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Importing ASCII data</title><meta name="Language" content="en-us" /><meta name="Microsoft.Help.Id" content="CCE945B2EC2C578D8C49120D55FACEE3" /><meta name="Description" content="Previous section: Copy/paste of worksheet data" /><meta name="Microsoft.Help.ContentType" content="Concepts" /><meta name="BrandingAware" content="true" /><link rel="stylesheet" type="text/css" href="../styles/branding-Website.css" /><script type="text/javascript" src="../scripts/jquery-1.11.0.min.js"></script><script type="text/javascript" src="../scripts/branding-Website.js"></script><script type="text/javascript" src="../scripts/clipboard.min.js"></script></head><body onload="OnLoad('cs')"><input type="hidden" id="userDataCache" class="userDataStyle" /><div class="pageHeader" id="PageHeader">Altaxo user manual and class reference<form id="SearchForm" method="get" action="#" onsubmit="javascript:TransferToSearchPage(); return false;"><input id="SearchTextBox" type="text" maxlength="200" /><button id="SearchButton" type="submit"></button></form></div><div class="pageBody"><div class="leftNav" id="leftNav"><div id="tocNav"><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html\1B7FE024E7E614BFA13DAA1FD005CB2E.htm" title="Altaxo user manual and class reference" tocid="roottoc">Altaxo user manual and class reference</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/1B7FE024E7E614BFA13DAA1FD005CB2E.htm" title="Altaxo user manual" tocid="1B7FE024E7E614BFA13DAA1FD005CB2E">Altaxo user manual</a></div><div class="toclevel1" data-toclevel="1" data-childrenloaded="true"><a class="tocExpanded" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/345E05B54F4611736070E46B38DD4CB5.htm" title="Tables and Worksheets" tocid="345E05B54F4611736070E46B38DD4CB5">Tables and Worksheets</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/5C8543F24C7EE1C52CD7211AC31DB592.htm" title="Data columns and property columns" tocid="5C8543F24C7EE1C52CD7211AC31DB592">Data columns and property columns</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/AA57528103751EB21A179BF18C6C5F58.htm" title="Column headers" tocid="AA57528103751EB21A179BF18C6C5F58">Column headers</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/6FAC01304D7EC3D8AE1C724CA084256B.htm" title="Creating a new worksheet" tocid="6FAC01304D7EC3D8AE1C724CA084256B">Creating a new worksheet</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/0F56118543F36CC6A6EB223F48A5B2C2.htm" title="Creating additional data columns or property columns" tocid="0F56118543F36CC6A6EB223F48A5B2C2">Creating additional data columns or property columns</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/9EC02FDB23AEF02047503483B7079F28.htm" title="Selection of columns and/or rows in a worksheet" tocid="9EC02FDB23AEF02047503483B7079F28">Selection of columns and/or rows in a worksheet</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/F71D3901373F20479F4C3575F2838494.htm" title="Copy/paste of worksheet data" tocid="F71D3901373F20479F4C3575F2838494">Copy/paste of worksheet data</a></div><div class="toclevel2 current" data-toclevel="2"><a data-tochassubtree="false" href="../html/CCE945B2EC2C578D8C49120D55FACEE3.htm" title="Importing ASCII data" tocid="CCE945B2EC2C578D8C49120D55FACEE3">Importing ASCII data</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/B09D5D470B8DCF524A698117E51D308B.htm" title="Changing the structure of a worksheet" tocid="B09D5D470B8DCF524A698117E51D308B">Changing the structure of a worksheet</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/742EC350D96B6D65DA918DE77373E534.htm" title="Worksheet Notes" tocid="742EC350D96B6D65DA918DE77373E534">Worksheet Notes</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/51AB2CB3ECBAFD1DD0F029C0B45B8046.htm" title="Worksheet Scripts and Column Scripts" tocid="51AB2CB3ECBAFD1DD0F029C0B45B8046">Worksheet Scripts and Column Scripts</a></div></div><div id="tocResizableEW" onmousedown="OnMouseDown(event);"></div><div id="TocResize" class="tocResize"><img id="ResizeImageIncrease" src="../icons/TocOpen.gif" onclick="OnIncreaseToc()" alt="Click or drag to resize" title="Click or drag to resize" /><img id="ResizeImageReset" src="../icons/TocClose.gif" style="display:none" onclick="OnResetToc()" alt="Click or drag to resize" title="Click or drag to resize" /></div></div><div class="topicContent" id="TopicContent"><table class="titleTable"><tr><td class="titleColumn"><h1>Importing ASCII data</h1></td></tr></table><span class="introStyle"></span> <div class="introduction"><p>
Previous section: <a href="F71D3901373F20479F4C3575F2838494.htm">Copy/paste of worksheet data</a></p><p>This topic contains the following sections:</p><ul class="autoOutline"><li class="outlineSectionEntry"><a href="#FFF4C2F612B2BAB9CF689F557A184E3A">Importing ASCII data from a single file into a single worksheet
</a></li><li class="outlineSectionEntry"><a href="#9BC603C8A9C16E1CE5AC496DA8097D99">Importing ASCII data from multiple files into a single worksheet
</a></li><li class="outlineSectionEntry"><a href="#E5EFC13BB357BF4A1093885F345139B9">Importing ASCII data from multiple files into separate worksheets
</a></li><li class="outlineSectionEntry"><a href="#048F6F0FD3BDC7133EB4130BF53BF21D">Importing multiple ASCII files into a single worksheet vertically
</a></li></ul><hr /></div><div class="collapsibleAreaRegion" id="FFF4C2F612B2BAB9CF689F557A184E3A"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID0RB')" onkeypress="SectionExpandCollapse_CheckKey('ID0RB', event)" tabindex="0"><img id="ID0RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Importing ASCII data from a single file into a single worksheet
</span></div><div id="ID0RBSection" class="collapsibleSection"><p>
To import ASCII data from a single file into a (single) worksheet, first
make the worksheet to import to the active document, or create a new
(preferably empty) worksheet.
</p><p>
Then choose File→Import→Ascii from the main menu, or use the
toolbar button (see Figure below).
</p><p><span class="media"><img alt="175BA38271F9EFD451538A761150E354" src="../media/175BA38271F9EFD451538A761150E354.png" /></span></p><p>
A file dialog opens. After selecting the Ascii file and pressing OK the
Ascii data are imported into your active worksheet. The import process
is a two-step process:
</p><ol><li><p>
The Ascii file is analyzed first. The first 30 lines of the Ascii
files are read, and the lines are analyzed for their structure. The
structure that is most frequently repeated in the other lines wins
the game and determines the number of columns and their type. The
recognized columns are created in the worksheet.
</p></li><li><p>
The data are then imported in the thus prepared worksheet.
</p></li></ol><p>
If the result of the import is not satisfactory, you can control the
import options by choosing File→Import→Ascii with options from
the main menu instead. Here too, at first a dialog opens in which you
can choose the file to import. The Ascii file is then analyzed, and the
result of the analysis is shown in another dialog.
</p><p><a href="ACAC6A80-7CE0-4CB9-B36C-B2FB6ACAB027.htm#711CB8B1917D15389B22470E2D11C2D9"><img src="../media/711CB8B1917D15389B22470E2D11C2D9.png" width="567" /></a></p><p>
The dialog is divided into three parts: in the upper part, the analysis
options are shown. In the middle part, the result of the analysis is
shown. The lower part contains some user options.
</p><p>
When you press the button “Analyze!”, the options in the upper part of
the dialog are used to analyze the Ascii file. Already known information
is used from the middle part. In the figure above, there is nothing left
to analyze, because on all results the checkbox is checked, meaning that
this result is already known.
</p><p>
Suppose that Altaxo’s automatic analysis has incorrectly recognized the
number of main header lines, and as a consequence, has also incorrectly
determined the number and the type of columns. You can then correct the
number of main header lines manually (if known to you). Leave the
checkbox “Known number of main header lines” checked in order to
indicate that the number of main header lines is already known. But
uncheck the checkbox “Known column types”. If you now press the button
“Analyze”, Altaxo runs the analysis again, but takes into account the
correct number of main header lines. Hopefully, this will now lead to
the correct recognition of the number and types of columns.
</p><p>
Likewise, you can correct any analysis result that you know better of,
and uncheck those results that you want to be analyzed again.
</p><p>
Finally, press OK to import the Ascii file into your worksheet.
</p></div><div class="collapsibleAreaRegion" id="9BC603C8A9C16E1CE5AC496DA8097D99"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID1RB')" onkeypress="SectionExpandCollapse_CheckKey('ID1RB', event)" tabindex="0"><img id="ID1RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Importing ASCII data from multiple files into a single worksheet
</span></div><div id="ID1RBSection" class="collapsibleSection"><p>
Suppose you have a spectrometer that stores every spectrum in a single
Ascii file. The data in each file is structured into two columns. The
first column usually contains the values of the wavelength, and the
second column the measured values (for instance absorbance).
Furthermore, suppose that you acquire a series of spectra, e.g. the time
dependence of some reaction, so that you have hundreds or even thousands
of spectra.
</p><p>
You probably not want to import each spectrum into a single worksheet,
because then you will get hundreds or thousands of worksheets. Instead,
it would be convenient if all spectra would be imported into a single
worksheet. And, because all spectra share the same wavelength values,
you will need only one wavelength column in your worksheet (instead of
one wavelength column per spectrum).
</p><p>
To import all spectra into a single worksheet, create a new (preferably
empty) worksheet or open an existing one, and then choose
File→Impor→Ascii (all into a single worksheet). A file dialog
opens, in which you have to select all files you want to import. After
pressing OK, the selected files will be sorted by their file name and in
this order imported into the current worksheet.
</p><p>
Note: Should it happen, that the x-column of one or more imported data
files is different from the first imported file: this is not a problem.
The new x-values will be imported into a different column, which gets a
new group number, and all other imported columns of that file will get
the same new group number.
</p><p>
Note: A property column named “FilePath” is created in the current
worksheet. The cells of this property column are filled with the file
name of the file where the data originate from.
</p><p>
In the figure below you can see the result after importing three
spectrum files.
</p><p><a href="ACAC6A80-7CE0-4CB9-B36C-B2FB6ACAB027.htm#1E66B99E8F58140906BC74D1B3D881CD"><img src="../media/1E66B99E8F58140906BC74D1B3D881CD.png" width="567" /></a></p><p>
As you can see, the first column contains the wavelength values. Because
there is only this one x-column, we conclude that the three spectra
share the same wavelength values. The next 3 columns contain the
spectral amplitudes of each spectrum. The property column “FilePath”
contains the file names of the spectrum files. As you can see, the
spectrometer codes the date and time into the filename. With the help of
a script, one can extract this date/time and use it to calculate the
time span relative to the start of measurement.
</p></div><div class="collapsibleAreaRegion" id="E5EFC13BB357BF4A1093885F345139B9"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID2RB')" onkeypress="SectionExpandCollapse_CheckKey('ID2RB', event)" tabindex="0"><img id="ID2RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Importing ASCII data from multiple files into separate worksheets
</span></div><div id="ID2RBSection" class="collapsibleSection"><p>
If you want to import Ascii data from multiple files into separate
worksheets, the most preferable way is to start when your current
document is either a graph, or there is no current document at all.
</p><p>
Background: if your current document is a worksheet, the first Ascii
file is imported into this worksheet, and the other files are imported
into newly created worksheets. The newly created worksheets get the name
of the corresponding Ascii file, but the first worksheet is not renamed.
</p><p>
Thus, either select a graph, or close all documents (main menu:
Window→Close all documents) before importing into separate
worksheets.
</p><p>
Choose File→Import→Ascii (or File→Import→Ascii with
Options), and select multiple Ascii files in the file dialog.
</p><p>
If you press OK, the selected files will be sorted by their file name,
and then imported into newly created worksheets. The new worksheets are
located in the root folder of the project.
</p><p>
The figure below shows the result after importing the three spectrum
files from the example of the previous chapter into separate worksheets.
</p><p><a href="ACAC6A80-7CE0-4CB9-B36C-B2FB6ACAB027.htm#3D7DD208F7ACE3197B8A626FD9BCF93F"><img src="../media/3D7DD208F7ACE3197B8A626FD9BCF93F.png" width="567" /></a></p><p>
Please note that the new worksheets get the names of their corresponding
Ascii files (see Project explorer at the right side). Furthermore, the
“Notes” tool window of each worksheet (at the bottom) contains a note
with information about the original file name and the date/time of the
import. In contrast to the example in chapter “Importing ASCII data from
multiple files into a single worksheet”, each worksheet now contains a
separate x-column with the wavelength values.
</p></div><div class="collapsibleAreaRegion" id="048F6F0FD3BDC7133EB4130BF53BF21D"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID3RB')" onkeypress="SectionExpandCollapse_CheckKey('ID3RB', event)" tabindex="0"><img id="ID3RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Importing multiple ASCII files into a single worksheet vertically
</span></div><div id="ID3RBSection" class="collapsibleSection"><p>
This command is useful if you have a time series of data in one file,
which is continued in another file and so on. You can then import all
data into a single worksheet. The data from the second file is appended
to the data from the first file. This means that the data from the
second file is imported starting from the next free data row of the
worksheet.
</p><p>
Create a new (preferably empty) worksheet or choose an existing one.
Then use File→Import→Import ASCII vertically from the menu.
Select multiple Ascii files in the file dialog. After pressing OK, the
files are sorted by their file name and imported into the current
worksheet.
</p><p>
I have to admit that this function makes no sense for my example (see
previous chapters) with the three spectra, but the next figure shows the
outcome after I imported the three spectra with this command.
</p><p><span class="media"><img alt="E21C36582AE1B83887AD842DCE2B70A5" src="../media/E21C36582AE1B83887AD842DCE2B70A5.png" /></span></p><p>
As you can see, data row [1310] is the end of the first spectrum. The
first row of the next spectrum is imported into data row [1311]. Note
that the file name of the imported file is stored in column ‘FilePath’
at the beginning of each data chunk.
</p></div><hr /><div id="ID4RBSection" class="collapsibleSection"><p>
Next section: <a href="B09D5D470B8DCF524A698117E51D308B.htm">Changing the structure of a worksheet</a></p></div></div></div><div id="pageFooter" class="pageFooter">Altaxo can be downloaded from <a href="https://sourceforge.net/projects/altaxo/files/Altaxo/">SourceForge</a>. Source code available on <a href="https://github.com/Altaxo/Altaxo">Github</a>.
<br /><a href="https://sourceforge.net/u/dlellinger/profile/">(C) Dr. Dirk Lellinger 2002 - <script>document.write(new Date().getFullYear()); </script></a><div class="feedbackLink">Send comments on this topic to
        <a id="HT_MailLink" href="mailto:dlellinger%40users.sourceforge.net?Subject=Altaxo user manual and class reference">dlellinger@users.sourceforge.net</a></div>
        <script type="text/javascript">
        var HT_mailLink = document.getElementById("HT_MailLink");
        var HT_mailLinkText = HT_mailLink.innerHTML;
        HT_mailLink.href += ": " + document.title + "\u0026body=" + encodeURIComponent("Your feedback is used to improve the documentation and the product. Your e-mail address will not be used for any other purpose and is disposed of after the issue you report is resolved. While working to resolve the issue that you report, you may be contacted via e-mail to get further details or clarification on the feedback you sent. After the issue you report has been addressed, you may receive an e-mail to let you know that your feedback has been addressed.");
        HT_mailLink.innerHTML = HT_mailLinkText;
        </script></div></body></html>