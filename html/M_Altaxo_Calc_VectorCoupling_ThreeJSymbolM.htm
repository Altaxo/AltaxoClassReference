<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"> </script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>VectorCoupling.ThreeJSymbolM Method </title><meta name="Language" content="en-us" /><meta name="System.Keywords" content="ThreeJSymbolM method" /><meta name="System.Keywords" content="VectorCoupling.ThreeJSymbolM method" /><meta name="Microsoft.Help.F1" content="Altaxo.Calc.VectorCoupling.ThreeJSymbolM" /><meta name="Microsoft.Help.Id" content="M:Altaxo.Calc.VectorCoupling.ThreeJSymbolM(System.Double,System.Double,System.Double,System.Double,System.Double@,System.Double@,System.Double[],System.Int32,System.Int32@)" /><meta name="Description" content="Evaluate the Wigner 3j symbol @@_SHFB_1 for all allowed values of m2, the other parameters being held fixed." /><meta name="Microsoft.Help.ContentType" content="Reference" /><meta name="BrandingAware" content="true" /><meta name="container" content="Altaxo.Calc" /><meta name="file" content="M_Altaxo_Calc_VectorCoupling_ThreeJSymbolM" /><meta name="guid" content="M_Altaxo_Calc_VectorCoupling_ThreeJSymbolM" /><link type="text/css" rel="stylesheet" href="../styles/highlight.css" /><script type="text/javascript" src="../scripts/highlight.js"> </script><link rel="stylesheet" type="text/css" href="../styles/branding-Website.css" /><script type="text/javascript" src="../scripts/jquery-1.11.0.min.js"></script><script type="text/javascript" src="../scripts/branding-Website.js"></script><script type="text/javascript" src="../scripts/clipboard.min.js"></script></head><body onload="OnLoad('cs')"><input type="hidden" id="userDataCache" class="userDataStyle" /><div class="pageHeader" id="PageHeader">Altaxo user manual and class reference<form id="SearchForm" method="get" action="#" onsubmit="javascript:TransferToSearchPage(); return false;"><input id="SearchTextBox" type="text" maxlength="200" /><button id="SearchButton" type="submit"></button></form></div><div class="pageBody"><div class="leftNav" id="leftNav"><div id="tocNav"><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html\1B7FE024E7E614BFA13DAA1FD005CB2E.htm" title="Altaxo user manual and class reference" tocid="roottoc">Altaxo user manual and class reference</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/R_Project_Documentation.htm" title="Altaxo class reference" tocid="R_Project_Documentation">Altaxo class reference</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/G_Altaxo.htm" title="Altaxo Namespaces" tocid="G_Altaxo">Altaxo Namespaces</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/G_Altaxo_Calc.htm" title="Altaxo.Calc Namespaces" tocid="G_Altaxo_Calc">Altaxo.Calc Namespaces</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/N_Altaxo_Calc.htm" title="Altaxo.Calc" tocid="N_Altaxo_Calc">Altaxo.Calc</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/T_Altaxo_Calc_VectorCoupling.htm" title="VectorCoupling Class" tocid="T_Altaxo_Calc_VectorCoupling">VectorCoupling Class</a></div><div class="toclevel1" data-toclevel="1" data-childrenloaded="true"><a class="tocExpanded" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/Methods_T_Altaxo_Calc_VectorCoupling.htm" title="VectorCoupling Methods" tocid="Methods_T_Altaxo_Calc_VectorCoupling">VectorCoupling Methods</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/M_Altaxo_Calc_VectorCoupling_ClebschGordan.htm" title="ClebschGordan Method " tocid="M_Altaxo_Calc_VectorCoupling_ClebschGordan">ClebschGordan Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/M_Altaxo_Calc_VectorCoupling_SixJSymbol.htm" title="SixJSymbol Method " tocid="M_Altaxo_Calc_VectorCoupling_SixJSymbol">SixJSymbol Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/M_Altaxo_Calc_VectorCoupling_ThreeJSymbolJ.htm" title="ThreeJSymbolJ Method " tocid="M_Altaxo_Calc_VectorCoupling_ThreeJSymbolJ">ThreeJSymbolJ Method </a></div><div class="toclevel2 current" data-toclevel="2"><a data-tochassubtree="false" href="../html/M_Altaxo_Calc_VectorCoupling_ThreeJSymbolM.htm" title="ThreeJSymbolM Method " tocid="M_Altaxo_Calc_VectorCoupling_ThreeJSymbolM">ThreeJSymbolM Method </a></div></div><div id="tocResizableEW" onmousedown="OnMouseDown(event);"></div><div id="TocResize" class="tocResize"><img id="ResizeImageIncrease" src="../icons/TocOpen.gif" onclick="OnIncreaseToc()" alt="Click or drag to resize" title="Click or drag to resize" /><img id="ResizeImageReset" src="../icons/TocClose.gif" style="display:none" onclick="OnResetToc()" alt="Click or drag to resize" title="Click or drag to resize" /></div></div><div class="topicContent" id="TopicContent"><table class="titleTable"><tr><td class="titleColumn"><h1>VectorCoupling<span id="LST5B215B09_0"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST5B215B09_0?cpp=::|nu=.");</script>ThreeJSymbolM Method </h1></td></tr></table><span class="introStyle"></span> <div class="summary">
             Evaluate the Wigner 3j symbol
             <div class="codeSnippetContainer"><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID0EABKBA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID0EABKBA');return false;" title="Copy">Copy</a></div></div><div id="ID0EABKBA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve">g(m2) = ( l1  l2     l3  )
        ( m1  m2  -m1-m2 )</pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0EABKBA");</script>
             for all allowed values of m2, the other parameters being held fixed.
             </div><p> </p>
    <strong>Namespace:</strong> 
   <a href="N_Altaxo_Calc.htm">Altaxo.Calc</a><br />
    <strong>Assembly:</strong>
   AltaxoCore (in AltaxoCore.dll) Version: 4.7.1867.1 (4.7.1867.1)<div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID1RB')" onkeypress="SectionExpandCollapse_CheckKey('ID1RB', event)" tabindex="0"><img id="ID1RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Syntax</span></div><div id="ID1RBSection" class="collapsibleSection"><div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID0EACA_tab1" class="codeSnippetContainerTabSingle">C#</div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID0EACA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID0EACA');return false;" title="Copy">Copy</a></div></div><div id="ID0EACA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="identifier">ThreeJSymbolM</span>(
	<span class="identifier">double</span> <span class="parameter">l1</span>,
	<span class="identifier">double</span> <span class="parameter">l2</span>,
	<span class="identifier">double</span> <span class="parameter">l3</span>,
	<span class="identifier">double</span> <span class="parameter">m1</span>,
	<span class="keyword">out</span> <span class="identifier">double</span> <span class="parameter">m2min</span>,
	<span class="keyword">out</span> <span class="identifier">double</span> <span class="parameter">m2max</span>,
	<span class="identifier">double</span>[] <span class="parameter">thrcof</span>,
	<span class="identifier">int</span> <span class="parameter">ndim</span>,
	<span class="keyword">out</span> <span class="identifier">int</span> <span class="parameter">errflag</span>
)</pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0EACA");</script><h4 class="subHeading">Parameters</h4><dl><dt><span class="parameter">l1</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/643eft0t" target="_blank">System<span id="LST5B215B09_1"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST5B215B09_1?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Double</a><br />Parameter in 3j symbol.</dd><dt><span class="parameter">l2</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/643eft0t" target="_blank">System<span id="LST5B215B09_2"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST5B215B09_2?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Double</a><br />Parameter in 3j symbol.</dd><dt><span class="parameter">l3</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/643eft0t" target="_blank">System<span id="LST5B215B09_3"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST5B215B09_3?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Double</a><br />Parameter in 3j symbol.</dd><dt><span class="parameter">m1</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/643eft0t" target="_blank">System<span id="LST5B215B09_4"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST5B215B09_4?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Double</a><br />Parameter in 3j symbol.</dd><dt><span class="parameter">m2min</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/643eft0t" target="_blank">System<span id="LST5B215B09_5"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST5B215B09_5?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Double</a><span id="LST5B215B09_6"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST5B215B09_6?cpp=%");</script><br />Smallest allowable m2 in 3j symbol.</dd><dt><span class="parameter">m2max</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/643eft0t" target="_blank">System<span id="LST5B215B09_7"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST5B215B09_7?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Double</a><span id="LST5B215B09_8"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST5B215B09_8?cpp=%");</script><br />Largest allowable m2 in 3j symbol.</dd><dt><span class="parameter">thrcof</span></dt><dd>Type: <span id="LST5B215B09_9"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST5B215B09_9?cpp=array&lt;");</script><a href="http://msdn2.microsoft.com/en-us/library/643eft0t" target="_blank">System<span id="LST5B215B09_10"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST5B215B09_10?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Double</a><span id="LST5B215B09_11"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST5B215B09_11?cpp=&gt;|vb=()|nu=[]");</script><br />Set of 3j coefficients generated by evaluating the
                                  3j symbol for all allowed values of m2.  thrcof(i)
                                  will contain g(m2min+i), i=0,2,...,m2max-m2min.
             </dd><dt><span class="parameter">ndim</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/td2s409d" target="_blank">System<span id="LST5B215B09_12"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST5B215B09_12?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Int32</a><br />Declared length of thrcof in calling program.</dd><dt><span class="parameter">errflag</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/td2s409d" target="_blank">System<span id="LST5B215B09_13"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST5B215B09_13?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Int32</a><span id="LST5B215B09_14"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST5B215B09_14?cpp=%");</script><br />
             Error flag.
             <p>errflag=0  No errors.</p><p>errflag=1  Either l1 &lt; abs(m1) or l1+abs(m1) non-integer.</p><p>errflag=2  abs(l1-l2)&lt;= l3 &lt;= l1+l2 not satisfied.</p><p>errflag=3  l1+l2+l3 not an integer.</p><p>errflag=4  m2max-m2min not an integer.</p><p>errflag=5  m2max less than m2min.</p><p>errflag=6  ndim less than m2max-m2min+1.</p></dd></dl></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID2RB')" onkeypress="SectionExpandCollapse_CheckKey('ID2RB', event)" tabindex="0"><img id="ID2RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Remarks</span></div><div id="ID2RBSection" class="collapsibleSection"><div class="codeSnippetContainer"><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID0EAAABA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID0EAAABA');return false;" title="Copy">Copy</a></div></div><div id="ID0EAAABA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve">Description:
------------

Although conventionally the parameters of the vector addition
coefficients satisfy certain restrictions, such <span class="highlight-keyword">as</span> being integers
or integers plus <span class="highlight-number">1</span>/<span class="highlight-number">2</span>, the restrictions imposed <span class="highlight-keyword">on</span> input to <span class="highlight-keyword">this</span>
subroutine are somewhat weaker. See, <span class="highlight-keyword">for</span> example, Section <span class="highlight-number">27.9</span> of
Abramowitz and Stegun or Appendix C of Volume II of A. Messiah.

The restrictions imposed by <span class="highlight-keyword">this</span> subroutine are

      <span class="highlight-number">1</span>. l1 &gt;= abs(m1) and l1+abs(m1) must be an integer
      <span class="highlight-number">2</span>. abs(l1-l2) &lt;= l3 &lt;= l1+l2
      <span class="highlight-number">3</span>. l1+l2+l3 must be an integer
      <span class="highlight-number">4</span>. m2max-m2min must be an integer, <span class="highlight-keyword">where</span>
         m2max=min(l2,l3-m1) and m2min=max(-l2,-l3-m1)

If the conventional restrictions are satisfied, then these
restrictions are also met.

The user should be cautious <span class="highlight-keyword">in</span> <span class="highlight-keyword">using</span> input parameters that <span class="highlight-keyword">do</span>
not satisfy the conventional restrictions. For example, the
the subroutine produces values of
      g(m2) = (<span class="highlight-number">0.75</span> <span class="highlight-number">1.50</span>   <span class="highlight-number">1.75</span>  )
              (<span class="highlight-number">0.25</span>  m2  <span class="highlight-number">-0.25</span>-m2)
<span class="highlight-keyword">for</span> m2=<span class="highlight-number">-1.5</span>,<span class="highlight-number">-0.5</span>,<span class="highlight-number">0.5</span>,<span class="highlight-number">1.5</span> but none of the symmetry properties of the
<span class="highlight-number">3</span>j symbol, <span class="highlight-keyword">set</span> forth <span class="highlight-keyword">on</span> page <span class="highlight-number">1056</span> of Messiah, <span class="highlight-keyword">is</span> satisfied.

The subroutine generates g(m2min), g(m2min<span class="highlight-number">+1</span>), ..., g(m2max)
<span class="highlight-keyword">where</span> m2min and m2max are defined above. The sequence g(m2) <span class="highlight-keyword">is</span>
generated by a three-term recurrence algorithm with scaling to
control overflow. Both backward and forward recurrence are used to
maintain numerical stability. The two recurrence sequences are
matched at an interior point and are normalized <span class="highlight-keyword">from</span> the unitary
property of <span class="highlight-number">3</span>j coefficients and Wigner's phase convention.

The algorithm <span class="highlight-keyword">is</span> suited to applications <span class="highlight-keyword">in</span> which large quantum
numbers arise, such <span class="highlight-keyword">as</span> <span class="highlight-keyword">in</span> molecular dynamics.

References:
-----------
 <span class="highlight-number">1</span>. Abramowitz, M., and Stegun, I. A., Eds., Handbook
    of Mathematical Functions with Formulas, Graphs
    and Mathematical Tables, NBS Applied Mathematics
    Series <span class="highlight-number">55</span>, June <span class="highlight-number">1964</span> and subsequent printings.
 <span class="highlight-number">2</span>. Messiah, Albert., Quantum Mechanics, Volume II,
    North-Holland Publishing Company, <span class="highlight-number">1963</span>.
 <span class="highlight-number">3</span>. Schulten, Klaus and Gordon, Roy G., Exact recursive
    evaluation of <span class="highlight-number">3</span>j and <span class="highlight-number">6</span>j coefficients <span class="highlight-keyword">for</span> quantum-
    mechanical coupling of angular momenta, J Math
    Phys, v <span class="highlight-number">16</span>, no. <span class="highlight-number">10</span>, October <span class="highlight-number">1975</span>, pp. <span class="highlight-number">1961</span>-<span class="highlight-number">1970</span>.
 <span class="highlight-number">4</span>. Schulten, Klaus and Gordon, Roy G., Semiclassical
    approximations to <span class="highlight-number">3</span>j  and <span class="highlight-number">6</span>j coefficients <span class="highlight-keyword">for</span>
    quantum-mechanical coupling of angular momenta,
    J Math Phys, v <span class="highlight-number">16</span>, no. <span class="highlight-number">10</span>, October <span class="highlight-number">1975</span>, pp. <span class="highlight-number">1971</span>-<span class="highlight-number">1988</span>.
 <span class="highlight-number">5</span>. Schulten, Klaus and Gordon, Roy G., Recursive
    evaluation of <span class="highlight-number">3</span>j and <span class="highlight-number">6</span>j coefficients, Computer
    Phys Comm, v <span class="highlight-number">11</span>, <span class="highlight-number">1976</span>, pp. <span class="highlight-number">269</span>-<span class="highlight-number">278</span>.
 <span class="highlight-number">6</span>. SLATEC library, category  C19,
    <span class="highlight-keyword">double</span> precision algorithm DRC3JM.F
    Keywords: <span class="highlight-number">3</span>j coefficients, <span class="highlight-number">3</span>j symbols, Clebsch-Gordan coefficients,
              Racah coefficients, vector addition coefficients,
              Wigner coefficients
    Author:   Gordon, R. G., Harvard University
              Schulten, K., Max Planck Institute
    Revision history  (YYMMDD)
    <span class="highlight-number">750101</span>  DATE WRITTEN
    <span class="highlight-number">880515</span>  SLATEC prologue added by G. C. Nielson, NBS; parameters
            HUGE and TINY revised to depend <span class="highlight-keyword">on</span> D1MACH.
    <span class="highlight-number">891229</span>  Prologue description rewritten; other prologue sections
            revised; MMATCH (location of match point <span class="highlight-keyword">for</span> recurrences)
            removed <span class="highlight-keyword">from</span> argument list; argument IER changed to serve
            only <span class="highlight-keyword">as</span> an error flag (previously, <span class="highlight-keyword">in</span> cases without error,
            it returned the number of scalings); number of error codes
            increased to provide more precise error information;
            program comments revised; SLATEC error handler calls
            introduced to enable printing of error messages to meet
            SLATEC standards. These changes were done by D. W. Lozier,
            M. A. McClain and J. M. Smith of the National Institute
            of Standards and Technology, formerly NBS.
    <span class="highlight-number">910415</span>  Mixed type expressions eliminated; variable C1 initialized;
            description of THRCOF expanded. These changes were done by
            D. W. Lozier.
 <span class="highlight-number">7</span>. Rewritting of the SLATEX algorithm <span class="highlight-keyword">in</span> C++ and adaption to the
    Matpack C++ Numerics and Graphics Library by Berndt M. Gammel
    <span class="highlight-keyword">in</span> June <span class="highlight-number">1997</span>.</pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0EAAABA");</script></div><div class="collapsibleAreaRegion" id="seeAlsoSection"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID3RB')" onkeypress="SectionExpandCollapse_CheckKey('ID3RB', event)" tabindex="0"><img id="ID3RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />See Also</span></div><div id="ID3RBSection" class="collapsibleSection"><h4 class="subHeading">Reference</h4><div class="seeAlsoStyle"><a href="T_Altaxo_Calc_VectorCoupling.htm">VectorCoupling Class</a></div><div class="seeAlsoStyle"><a href="N_Altaxo_Calc.htm">Altaxo.Calc Namespace</a></div></div></div></div><div id="pageFooter" class="pageFooter">Altaxo can be downloaded from <a href="https://sourceforge.net/projects/altaxo/files/Altaxo/">SourceForge</a>. Source code available on <a href="https://github.com/Altaxo/Altaxo">Github</a>.<p><a href="https://sourceforge.net/u/dlellinger/profile/" target="_blank">(C) Dr. Dirk Lellinger 2002 - 2018</a></p><div class="feedbackLink">Send comments on this topic to
        <a id="HT_MailLink" href="mailto:dlellinger%40users.sourceforge.net?Subject=Altaxo user manual and class reference">dlellinger@users.sourceforge.net</a></div>
        <script type="text/javascript">
        var HT_mailLink = document.getElementById("HT_MailLink");
        var HT_mailLinkText = HT_mailLink.innerHTML;
        HT_mailLink.href += ": " + document.title + "\u0026body=" + encodeURIComponent("Your feedback is used to improve the documentation and the product. Your e-mail address will not be used for any other purpose and is disposed of after the issue you report is resolved. While working to resolve the issue that you report, you may be contacted via e-mail to get further details or clarification on the feedback you sent. After the issue you report has been addressed, you may receive an e-mail to let you know that your feedback has been addressed.");
        HT_mailLink.innerHTML = HT_mailLinkText;
        </script> </div></body></html>