<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="Microsoft.Help.SelfBranded" content="true" /><meta name="Language" content="en-us" /><meta name="Microsoft.Help.Locale" content="en-us" /><meta name="Microsoft.Help.TopicLocale" content="en-us" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"></script><title>Importing data</title><meta name="Microsoft.Help.Id" content="0D1CC7EABBD1395A9C7E70C02EE259E7" /><meta name="Microsoft.Help.ContentType" content="Concepts" /><meta name="Description" content="Previous section: Copy/paste of worksheet data" /><link rel="stylesheet" type="text/css" href="../styles/branding-Website.css" /><script type="text/javascript" src="../scripts/jquery-3.5.1.min.js"></script><script type="text/javascript" src="../scripts/branding-Website.js"></script><script type="text/javascript" src="../scripts/clipboard.min.js"></script></head><body onload="SetDefaultLanguage('cs');"><input type="hidden" id="userDataCache" class="userDataStyle" /><div id="PageHeader" class="pageHeader">Altaxo user manual and class reference<form id="SearchForm" method="get" action="#" onsubmit="TransferToSearchPage(); return false;"><input id="SearchTextBox" type="text" maxlength="200" /><button id="SearchButton" type="submit"></button></form></div><div class="pageBody"><div class="leftNav" id="leftNav"><div id="tocNav"><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/1B7FE024E7E614BFA13DAA1FD005CB2E.htm" title="Altaxo user manual and class reference" tocid="roottoc">Altaxo user manual and class reference</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/1B7FE024E7E614BFA13DAA1FD005CB2E.htm" title="Altaxo user manual" tocid="1B7FE024E7E614BFA13DAA1FD005CB2E">Altaxo user manual</a></div><div class="toclevel1" data-toclevel="1" data-childrenloaded="true"><a class="tocExpanded" onclick="Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/345E05B54F4611736070E46B38DD4CB5.htm" title="Tables and Worksheets" tocid="345E05B54F4611736070E46B38DD4CB5">Tables and Worksheets</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/5C8543F24C7EE1C52CD7211AC31DB592.htm" title="Data columns and property columns" tocid="5C8543F24C7EE1C52CD7211AC31DB592">Data columns and property columns</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/AA57528103751EB21A179BF18C6C5F58.htm" title="Column headers" tocid="AA57528103751EB21A179BF18C6C5F58">Column headers</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/6FAC01304D7EC3D8AE1C724CA084256B.htm" title="Creating a new worksheet" tocid="6FAC01304D7EC3D8AE1C724CA084256B">Creating a new worksheet</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/0F56118543F36CC6A6EB223F48A5B2C2.htm" title="Creating additional data columns or property columns" tocid="0F56118543F36CC6A6EB223F48A5B2C2">Creating additional data columns or property columns</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/9EC02FDB23AEF02047503483B7079F28.htm" title="Selection of columns and/or rows in a worksheet" tocid="9EC02FDB23AEF02047503483B7079F28">Selection of columns and/or rows in a worksheet</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/F71D3901373F20479F4C3575F2838494.htm" title="Copy/paste of worksheet data" tocid="F71D3901373F20479F4C3575F2838494">Copy/paste of worksheet data</a></div><div class="toclevel2 current" data-toclevel="2"><a data-tochassubtree="false" href="../html/0D1CC7EABBD1395A9C7E70C02EE259E7.htm" title="Importing data" tocid="0D1CC7EABBD1395A9C7E70C02EE259E7">Importing data</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/B09D5D470B8DCF524A698117E51D308B.htm" title="Changing the structure of a worksheet" tocid="B09D5D470B8DCF524A698117E51D308B">Changing the structure of a worksheet</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/742EC350D96B6D65DA918DE77373E534.htm" title="Worksheet Notes" tocid="742EC350D96B6D65DA918DE77373E534">Worksheet Notes</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/51AB2CB3ECBAFD1DD0F029C0B45B8046.htm" title="Worksheet Scripts and Column Scripts" tocid="51AB2CB3ECBAFD1DD0F029C0B45B8046">Worksheet Scripts and Column Scripts</a></div></div><div id="tocResizableEW" onmousedown="OnMouseDown(event);"></div><div id="TocResize" class="tocResize"><img id="ResizeImageIncrease" src="../icons/TocOpen.gif" onclick="OnIncreaseToc()" alt="Click or drag to resize" title="Click or drag to resize" /><img id="ResizeImageReset" src="../icons/TocClose.gif" style="display:none" onclick="OnResetToc()" alt="Click or drag to resize" title="Click or drag to resize" /></div></div><div id="TopicContent" class="topicContent"><table class="titleTable"><tr><td class="titleColumn"><h1>Importing data</h1></td></tr></table><div><p>
Previous section: <a href="F71D3901373F20479F4C3575F2838494.htm">Copy/paste of worksheet data</a></p><p>This topic contains the following sections:</p><ul><li><a href="#Section_Tables_ImportingAscii">Importing ASCII data</a></li><li><a href="#4D35A597A85B3E34D4E106327C613F18">Importing Bruker Opus files</a></li><li><a href="#A5BA93CA67BDC644250D380397EB154C">Importing Excel .xlsx files</a></li><li><a href="#EC991C249E834EA00CCC2CEE70302673">Importing Galactic SPC files</a></li><li><a href="#3E068D9FF2127C78F33CA21E0D60CBE8">Import JcampDX files</a></li><li><a href="#674B2F01BF217EF1B2BFFCDC1D77C21D">Importing NeXus files</a></li><li><a href="#EFB0729EBF100744EFB427B47ECA230A">Importing Nicolet spectral files</a></li><li><a href="#E2E8BA9CA692DE544D7DCC06F8106956">Importing Origin files</a></li><li><a href="#A509DB28A236673F8A27EDCA3A89BEE7">Importing Princeton Instruments spectral files</a></li><li><a href="#4221C27DFEC7CB2F7D14CBC04B9DA725">Importing CHADA files</a></li><li><a href="#1F1AAFADC4EF3F7BD0D8BE6B023E5EC3">Importing Renishaw spectral files</a></li><li><a href="#0D8FC420A513A74FCE8A0D37B84C60BC">Importing WiTec project files</a></li><li><a href="#9AEBB231B81FBCD7DCADD4C077D9F950">Importing images as data</a></li><li><a href="#03B76D9C9A5CBE3DB348B3C817E52BFC">Importing using a self-written import script</a></li></ul><hr /><p>
Basically, there are three different ways to import data, which differ by the number of options you can choose.
</p><ul><li><p>
Import via the file menu (menu <span class="code">File</span>→<span class="code">Import</span>)
</p></li><li><p>
Import via the import button in the toolbar
</p></li><li><p>
Import via the File explorer
</p></li></ul><p><span class="mediaInline"><img alt="9F760815B5198BD233751A9D1385C52D" src="../media/9F760815B5198BD233751A9D1385C52D.png" /></span></p><p>
Fig.1: Import via the file menu. This also gives you an idea which file formats are supported by Altaxo.
</p><p>
The import via the <strong>file menu</strong> (menu <span class="code">File</span>→<span class="code">Import</span>) offers the highest number of import options. First of all, you select the file format you want to import by choosing one of the menu points. Then you can not only import multiple files at once. For file formats which can contain more than one table (e.g., Origin, Nexus, SPC, etc.) you can also choose whether those tables should be imported in individual tables in Altaxo, or into only one merged table. Furthermore, there are options for the naming of the data columns.
</p><p><span class="mediaInline"><img alt="E8EF04E5701A344D78E8C122CCD7A6ED" src="../media/E8EF04E5701A344D78E8C122CCD7A6ED.png" /></span></p><p>
Fig.2: Import via the import button in Altaxo's toolbar.
</p><p>
The import via the <strong>import button in the toolbar</strong> is intended to import only one file at once, thus it offers slightly less options compared to the import via the File menu described above. In contrast to import via File menu, the data format is detected automatically, and the importer which is most suitable is used for import the data. Thus, in case the automatic detection of the data format fails, and you know which data format is used, then you better import your data via the File menu.
</p><p><span class="mediaInline"><img alt="09D1AA90E9BC94358ECB8CE658BE302F" src="../media/09D1AA90E9BC94358ECB8CE658BE302F.png" /></span></p><p>
Fig.3: Import via the file explorer. In order to import the file, double-click on it.
</p><p>
The import via the <strong>File explorer</strong> offers the least possibilities. You can only import one file at once. The file format is detected automatically. In case the file contains more than one table, all tables are imported into only one Altaxo table. To import a file, open the file explorer (menu <span class="code">View</span>→<span class="code">Files</span>),
then navigate to the file you want to import and double-click on it.
</p><p><span class="mediaInline"><img alt="D826279F757A5E5A2EF841D5CA86A046" src="../media/D826279F757A5E5A2EF841D5CA86A046.png" /></span></p><p>
Fig.4: By clicking on the question mark in the toolbar <span class="mediaInline"><artLink target="Icons.16x16" /></span>, you can open the table data source. For tables which contain imported data, the table data source remembers the origin and options of the data import. If you click the toolbar button with the red triangle <span class="mediaInline"><artLink target="Icons.16x16" /></span> (right from the question mark toolbar button), you will re-import the data without opening the dialog.
</p><p>
After your import was successful, you will see one or more tables (depending on the file format and your options) in the project explorer which contain the imported data. Each table remembers the origin of the data in an object named <span class="code">TableDataSource</span>. By clicking on the question mark in the toolbar <span class="mediaInline"><artLink target="Icons.16x16" /></span>, you can open the dialog of this <span class="code">TableDataSource</span>, and change the file name or change the import options. This is very convenient if you have to import repeatedly: simply clone the table, and then change in the cloned table the file name in the <span class="code">TableDataSource</span>.
</p><p>
In the following chapters the individual file formats are described in more detail.
</p></div><div class="collapsibleAreaRegion" id="Section_Tables_ImportingAscii"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDBAB')" onkeypress="SectionExpandCollapse_CheckKey('IDBAB', event)" tabindex="0"><img id="IDBABToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Importing ASCII data</span></div><div id="IDBABSection" class="collapsibleSection"><h4 id="BA2AFBE4E7255BE6C2541952B2A9D087">Importing ASCII data from a single file into a single worksheet</h4><p>
To import ASCII data from a single file into a (single) worksheet, first
make the worksheet to import to the active document, or create a new
(preferably empty) worksheet.
</p><p>
Then choose File→Import→Ascii from the main menu, or use the
import toolbar button.
</p><p>
A file dialog opens. After selecting the Ascii file and pressing OK the
Ascii data are imported into your active worksheet. The import process
is a two-step process:
</p><ol><li><p>
The Ascii file is analyzed first. The first 30 lines of the Ascii
files are read, and the lines are analyzed for their structure. The
structure that is most frequently repeated in the other lines wins
the game and determines the number of columns and their type. The
recognized columns are created in the worksheet.
</p></li><li><p>
The data are then imported in the thus prepared worksheet.
</p></li></ol><p>
If the result of the import is not satisfactory, you can control the
import options by choosing File→Import→Ascii with options from
the main menu instead. Here too, at first a dialog opens in which you
can choose the file to import. The Ascii file is then analyzed, and the
result of the analysis is shown in another dialog.
</p><p><a href="ACAC6A80-7CE0-4CB9-B36C-B2FB6ACAB027.htm#711CB8B1917D15389B22470E2D11C2D9"><img src="../media/711CB8B1917D15389B22470E2D11C2D9.png" width="567"></img></a></p><p>
The dialog is divided into three parts: in the upper part, the analysis
options are shown. In the middle part, the result of the analysis is
shown. The lower part contains some user options.
</p><p>
When you press the button “Analyze!”, the options in the upper part of
the dialog are used to analyze the Ascii file. Already known information
is used from the middle part. In the figure above, there is nothing left
to analyze, because on all results the checkbox is checked, meaning that
this result is already known.
</p><p>
Suppose that Altaxo’s automatic analysis has incorrectly recognized the
number of main header lines, and as a consequence, has also incorrectly
determined the number and the type of columns. You can then correct the
number of main header lines manually (if known to you). Leave the
checkbox “Known number of main header lines” checked in order to
indicate that the number of main header lines is already known. But
uncheck the checkbox “Known column types”. If you now press the button
“Analyze”, Altaxo runs the analysis again, but takes into account the
correct number of main header lines. Hopefully, this will now lead to
the correct recognition of the number and types of columns.
</p><p>
Likewise, you can correct any analysis result that you know better of,
and uncheck those results that you want to be analyzed again.
</p><p>
Finally, press OK to import the Ascii file into your worksheet.
</p><h4 id="CAE12899C69AC6767A51CFE5FCCE04A1">Importing ASCII data from multiple files into a single worksheet</h4><p>
Suppose you have a spectrometer that stores every spectrum in a single
Ascii file. The data in each file is structured into two columns. The
first column usually contains the values of the wavelength, and the
second column the measured values (for instance absorbance).
Furthermore, suppose that you acquire a series of spectra, e.g. the time
dependence of some reaction, so that you have hundreds or even thousands
of spectra.
</p><p>
You probably not want to import each spectrum into a single worksheet,
because then you will get hundreds or thousands of worksheets. Instead,
it would be convenient if all spectra would be imported into a single
worksheet. And, because all spectra share the same wavelength values,
you will need only one wavelength column in your worksheet (instead of
one wavelength column per spectrum).
</p><p>
To import all spectra into a single worksheet, create a new (preferably
empty) worksheet or open an existing one, and then choose
File→Impor→Ascii (all into a single worksheet). A file dialog
opens, in which you have to select all files you want to import. After
pressing OK, the selected files will be sorted by their file name and in
this order imported into the current worksheet.
</p><p>
Note: Should it happen, that the x-column of one or more imported data
files is different from the first imported file: this is not a problem.
The new x-values will be imported into a different column, which gets a
new group number, and all other imported columns of that file will get
the same new group number.
</p><p>
Note: A property column named “FilePath” is created in the current
worksheet. The cells of this property column are filled with the file
name of the file where the data originate from.
</p><p>
In the figure below you can see the result after importing three
spectrum files.
</p><p><a href="ACAC6A80-7CE0-4CB9-B36C-B2FB6ACAB027.htm#1E66B99E8F58140906BC74D1B3D881CD"><img src="../media/1E66B99E8F58140906BC74D1B3D881CD.png" width="567"></img></a></p><p>
As you can see, the first column contains the wavelength values. Because
there is only this one x-column, we conclude that the three spectra
share the same wavelength values. The next 3 columns contain the
spectral amplitudes of each spectrum. The property column “FilePath”
contains the file names of the spectrum files. As you can see, the
spectrometer codes the date and time into the filename. With the help of
a script, one can extract this date/time and use it to calculate the
time span relative to the start of measurement.
</p><h4 id="BE1A1D6CD9DDB5CAA2B855A41908E1FA">Importing ASCII data from multiple files into separate worksheets</h4><p>
If you want to import Ascii data from multiple files into separate
worksheets, the most preferable way is to start when your current
document is either a graph, or there is no current document at all.
</p><p>
Background: if your current document is a worksheet, the first Ascii
file is imported into this worksheet, and the other files are imported
into newly created worksheets. The newly created worksheets get the name
of the corresponding Ascii file, but the first worksheet is not renamed.
</p><p>
Thus, either select a graph, or close all documents (main menu:
Window→Close all documents) before importing into separate
worksheets.
</p><p>
Choose File→Import→Ascii (or File→Import→Ascii with
Options), and select multiple Ascii files in the file dialog.
</p><p>
If you press OK, the selected files will be sorted by their file name,
and then imported into newly created worksheets. The new worksheets are
located in the root folder of the project.
</p><p>
The figure below shows the result after importing the three spectrum
files from the example of the previous chapter into separate worksheets.
</p><p><a href="ACAC6A80-7CE0-4CB9-B36C-B2FB6ACAB027.htm#3D7DD208F7ACE3197B8A626FD9BCF93F"><img src="../media/3D7DD208F7ACE3197B8A626FD9BCF93F.png" width="567"></img></a></p><p>
Please note that the new worksheets get the names of their corresponding
Ascii files (see Project explorer at the right side). Furthermore, the
“Notes” tool window of each worksheet (at the bottom) contains a note
with information about the original file name and the date/time of the
import. In contrast to the example in chapter “Importing ASCII data from
multiple files into a single worksheet”, each worksheet now contains a
separate x-column with the wavelength values.
</p><h4 id="335FB5B392C707A99569331DE69711F6">Importing multiple ASCII files into a single worksheet vertically</h4><p>
This command is useful if you have a time series of data in one file,
which is continued in another file and so on. You can then import all
data into a single worksheet. The data from the second file is appended
to the data from the first file. This means that the data from the
second file is imported starting from the next free data row of the
worksheet.
</p><p>
Create a new (preferably empty) worksheet or choose an existing one.
Then use File→Import→Import ASCII vertically from the menu.
Select multiple Ascii files in the file dialog. After pressing OK, the
files are sorted by their file name and imported into the current
worksheet.
</p><p>
I have to admit that this function makes no sense for my example (see
previous chapters) with the three spectra, but the next figure shows the
outcome after I imported the three spectra with this command.
</p><p><span class="mediaInline"><img alt="E21C36582AE1B83887AD842DCE2B70A5" src="../media/E21C36582AE1B83887AD842DCE2B70A5.png" /></span></p><p>
As you can see, data row [1310] is the end of the first spectrum. The
first row of the next spectrum is imported into data row [1311]. Note
that the file name of the imported file is stored in column ‘FilePath’
at the beginning of each data chunk.
</p></div><div class="collapsibleAreaRegion" id="4D35A597A85B3E34D4E106327C613F18"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDCAB')" onkeypress="SectionExpandCollapse_CheckKey('IDCAB', event)" tabindex="0"><img id="IDCABToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Importing Bruker Opus files</span></div><div id="IDCABSection" class="collapsibleSection"><p>
Bruker Opus files usually have the extension <span class="code">.0</span>. This is a binary file format which is used for spectra measured with Bruker spectrometers. The file contains one spectrum.
</p></div><div class="collapsibleAreaRegion" id="A5BA93CA67BDC644250D380397EB154C"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDDAB')" onkeypress="SectionExpandCollapse_CheckKey('IDDAB', event)" tabindex="0"><img id="IDDABToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Importing Excel .xlsx files</span></div><div id="IDDABSection" class="collapsibleSection"><p>
Altaxo supports the import of Excel .xlsx files. The older format .xls is not supported. Since Excel columns can contain different types (text, numbers etc.), but columns in Altaxo can only hold a specific type, the importer determines automatically which type is most suitable. This means, that if an Excel column not only contains numbers, but also text, the resulting column type in Altaxo is a text column.
</p></div><div class="collapsibleAreaRegion" id="EC991C249E834EA00CCC2CEE70302673"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDEAB')" onkeypress="SectionExpandCollapse_CheckKey('IDEAB', event)" tabindex="0"><img id="IDEABToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Importing Galactic SPC files</span></div><div id="IDEABSection" class="collapsibleSection"><p>
Galactic SPC files usually contain spectral data. They usually have the extension <span class="code">.spc</span>. Galactic SPC is a binary file format consisting of a main header describing the contents, followed by the binary data section. One .spc file can contain multiple spectra.
</p><p>
References:
</p><p>
[1] <a href="https://en.wikipedia.org/wiki/SPC_file_format" target="_blank" rel="noopener noreferrer">SPC file format</a><br />
[2] <a href="https://www.google.com/search?q=Galactic+Universal+Data+Format+Specification" target="_blank" rel="noopener noreferrer">Galactic Universal Data Format Specification 9/4/97</a></p></div><div class="collapsibleAreaRegion" id="3E068D9FF2127C78F33CA21E0D60CBE8"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDFAB')" onkeypress="SectionExpandCollapse_CheckKey('IDFAB', event)" tabindex="0"><img id="IDFABToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Import JcampDX files</span></div><div id="IDFABSection" class="collapsibleSection"><p>
JCAMP-DX format was developed by the Joint Committee on Atomic and Molecular Physical data, originally for Near Infrared (NIR) spectra, but the format can be used for other spectra as well. It is an Ascii based format with special formatting. The files usually have the extension <span class="code">.dx</span> or <span class="code">.jdx</span>. Typically one file contains one spectrum, but multiple spectra per file are supported as well, simply by appending the other spectra.
</p><p>
Reference:
</p><p>
[1] R. S. McDonald, and P. A. Wilks, Jr., "JCAMP-DX: A Standard Form for Exchange of Infrared Spectra in Computer Readable Form", Applied Spectroscopy, Vol. 42, No.1, (1988), pp. 151-162, <a href="https://doi.org/10.1366/0003702884428734" target="_blank" rel="noopener noreferrer">https://doi.org/10.1366/0003702884428734</a></p></div><div class="collapsibleAreaRegion" id="674B2F01BF217EF1B2BFFCDC1D77C21D"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDGAB')" onkeypress="SectionExpandCollapse_CheckKey('IDGAB', event)" tabindex="0"><img id="IDGABToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Importing NeXus files</span></div><div id="IDGABSection" class="collapsibleSection"><p>
The NeXus file format is a file format driven by the  <a href="https://www.nexusformat.org/" target="_blank" rel="noopener noreferrer">NeXus community</a> with a growing field of applications. Its base format is <span class="code">.HDF5</span>. Nexus files usually have the extension <span class="code">.nx</span> or <span class="code">.nxs</span>.
</p><p>
Since typically a NeXus file can contain multiple tables, it is recommended to import these files be the <span class="code">File</span>→<span class="code">Import</span> menu, so that you can change the options how those multiple tables are handled.
</p><p>
References:
</p><p>
[1] <a href="https://www.nexusformat.org/" target="_blank" rel="noopener noreferrer">https://www.nexusformat.org/</a></p></div><div class="collapsibleAreaRegion" id="EFB0729EBF100744EFB427B47ECA230A"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDHAB')" onkeypress="SectionExpandCollapse_CheckKey('IDHAB', event)" tabindex="0"><img id="IDHABToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Importing Nicolet spectral files</span></div><div id="IDHABSection" class="collapsibleSection"><p>
Altaxo supports the import of Nicolet spectral files with the extension <span class="code">.SPA</span>. This is a binary file format, supporting one spectrum per file.
</p><p>
References:
</p><p>
[1] <a href="https://github.com/aitap/spa2txt" target="_blank" rel="noopener noreferrer">C++ program which converts .spa files to text</a></p></div><div class="collapsibleAreaRegion" id="E2E8BA9CA692DE544D7DCC06F8106956"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDIAB')" onkeypress="SectionExpandCollapse_CheckKey('IDIAB', event)" tabindex="0"><img id="IDIABToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Importing Origin files</span></div><div id="IDIABSection" class="collapsibleSection"><p>
Altaxo supports the import of all data tables (spreadsheets and matrices) from Origin project files. Only the old format with the extension <span class="code">.OPJ</span> is supported. Files with the new format <span class="code">.OPJU</span> can not be read.
If you by chance know about how the new .OPJU format is structured, let me know by <a href="https://github.com/Altaxo/Altaxo/issues" target="_blank" rel="noopener noreferrer">opening a Github issue</a>.
</p><p>
References:
</p><p>
[1] <a href="https://github.com/Altaxo/LibOriginCSharp" target="_blank" rel="noopener noreferrer">CSharp implementation of liborigin</a></p><p>
[2] <a href="https://github.com/Makhber/liborigin" target="_blank" rel="noopener noreferrer">Original C++ code of liborigin</a></p></div><div class="collapsibleAreaRegion" id="A509DB28A236673F8A27EDCA3A89BEE7"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDJAB')" onkeypress="SectionExpandCollapse_CheckKey('IDJAB', event)" tabindex="0"><img id="IDJABToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Importing Princeton Instruments spectral files</span></div><div id="IDJABSection" class="collapsibleSection"><p>
Altaxo supports the import of spectral files from Princeton Instruments devices. The file extension usually used for those files is <span class="code">.SPE</span>. Those files are binary files with an Xml section containing the document metadata at the end of the file. The format is rather complex and supports beside spectra (multiple spectra per file) also image data.
</p><p>
References:
</p><p>
[1] <a href="https://github.com/ashirsch/spe2py" target="_blank" rel="noopener noreferrer">Python implementation</a></p></div><div class="collapsibleAreaRegion" id="4221C27DFEC7CB2F7D14CBC04B9DA725"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDKAB')" onkeypress="SectionExpandCollapse_CheckKey('IDKAB', event)" tabindex="0"><img id="IDKABToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Importing CHADA files</span></div><div id="IDKABSection" class="collapsibleSection"><p>
The CHADA file format is based on <span class="code">.HDF5</span>. It consists of one or multiple HDF5 data sets, located in the root folder of the .HDF5 file. All data sets that are located in the root directory of the <span class="code">.HDF5</span> file are imported into Altaxo. The file extension of the Chada files is <span class="code">.cha</span>.
</p><p>
References:
</p><p>
[1] <a href="https://www.hdfgroup.org/solutions/hdf5/" target="_blank" rel="noopener noreferrer">HDF5 file format</a></p></div><div class="collapsibleAreaRegion" id="1F1AAFADC4EF3F7BD0D8BE6B023E5EC3"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDLAB')" onkeypress="SectionExpandCollapse_CheckKey('IDLAB', event)" tabindex="0"><img id="IDLABToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Importing Renishaw spectral files</span></div><div id="IDLABSection" class="collapsibleSection"><p>
Altaxo is able to import spectral files from Renishaw instruments. Only files with the extension <span class="code">.wdf</span> are supported. The format is a block based format, containing one or more spectra with a common x-axis.
</p><p>
References:
</p><p>
[1] Henderson, Alex <a href="https://zenodo.org/records/495477" target="_blank" rel="noopener noreferrer">DOI:10.5281/zenodo.495477</a></p><p>
[2] <a href="https://github.com/alchem0x2A/py-wdf-reader/blob/master/renishawWiRE/wdfReader.py" target="_blank" rel="noopener noreferrer">Python implementation</a></p></div><div class="collapsibleAreaRegion" id="0D8FC420A513A74FCE8A0D37B84C60BC"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDMAB')" onkeypress="SectionExpandCollapse_CheckKey('IDMAB', event)" tabindex="0"><img id="IDMABToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Importing WiTec project files</span></div><div id="IDMABSection" class="collapsibleSection"><p>
Altaxo supports the import of WiTec project files. WiTec project files are very complex and can contain multidimensional spectra and images. Only the spectra import is supported for now. WiTec project files usually have the extension `.wip'. The format is very complex, and can contain multiple spectra and images.
</p><p>
[1] J. T. Holmi, H. Lipsanen, "WITio: A MATLAB data evaluation toolbox to script broader insights into big data from WITec microscopes", SoftwareX 18 (2022), 101009, doi: <a href="https://doi.org/10.1016/j.softx.2022.101009" target="_blank" rel="noopener noreferrer">https://doi.org/10.1016/j.softx.2022.101009</a></p><p>
[2] <a href="https://gitlab.com/jtholmi/wit_io/-/blob/master/+WITio/+doc/README%20on%20WIT-tag%20format.txt" target="_blank" rel="noopener noreferrer">Wit tag format description</a></p><p>
[3] <a href="https://gitlab.com/jtholmi/wit_io" target="_blank" rel="noopener noreferrer">Mathlab implementation</a></p><p>
[4] <a href="https://git.photonicdata.science/py-packages/photonicdata-files-wip" target="_blank" rel="noopener noreferrer">Phyton implementation</a></p></div><div class="collapsibleAreaRegion" id="9AEBB231B81FBCD7DCADD4C077D9F950"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDNAB')" onkeypress="SectionExpandCollapse_CheckKey('IDNAB', event)" tabindex="0"><img id="IDNABToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Importing images as data</span></div><div id="IDNABSection" class="collapsibleSection"><p>
Data from images can also be imported into Altaxo. For color images, you can choose which color channel to import, or only importing the luminance values.
</p></div><div class="collapsibleAreaRegion" id="03B76D9C9A5CBE3DB348B3C817E52BFC"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDOAB')" onkeypress="SectionExpandCollapse_CheckKey('IDOAB', event)" tabindex="0"><img id="IDOABToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Importing using a self-written import script</span></div><div id="IDOABSection" class="collapsibleSection"><p>
By choosing <span class="code">File</span>→<span class="code">Import</span>→<span class="code">Using file import script</span> you can write your own script to import files.
The advantage compared to a worksheet script is that the TableDataSource still remembers where the data come from, and that the script will not change if the file name(s) change.
</p><p>
At first, create a new, empty worksheet to import the data into, or select an existing one. Then, use the menu item <span class="code">File</span>→<span class="code">Import</span>→<span class="code">Using file import script</span> to open the import script dialog.
</p><p><span class="mediaInline"><img alt="05937921672D622B9FAA9726F8020D73" src="../media/05937921672D622B9FAA9726F8020D73.png" /></span></p><p>
Fig.1: Import script dialog after you open it (without expanding the script header)
</p><p>
By clicking on the '+' sign in line 1 of the script, you can expand the script header to see which variables are available in your script.
</p><p><span class="mediaInline"><img alt="1F6AEA6B69285521251227CC8FD4DAC0" src="../media/1F6AEA6B69285521251227CC8FD4DAC0.png" /></span></p><p>
Fig.2: By clicking on the '+' sign in line 1 of <a href="0D1CC7EABBD1395A9C7E70C02EE259E7.htm#Fig_Tables_ImportData_ImportScript_ScriptWithUnexpandedHeader">Fig.1</a>, you can expand the script header to see the lines that define some helper functions and the Execute function.
</p><p><a href="0D1CC7EABBD1395A9C7E70C02EE259E7.htm#Fig_Tables_ImportData_ImportScript_ScriptWithExpandedHeader">Fig.2</a> requires some explanation:
</p><ul><li><p>
In line 15, the function <span class="code">CanAcceptMultipleFiles</span> define whether your script can process multiple files. The default return value, as you can see, is <span class="code">false</span>. Set it to <span class="code">true</span> if your script can process multiple files.
</p></li><li><p>
In line 18, you can define your default extension. For instance, if the extension of your file is .abc, then replace <span class="code">"*.*", "All files(*.*)"</span> by <span class="code">"*.abc", "My ABC files (*.abc)"</span>.
</p></li><li><p>
Line 20 defines the Execute function that is used to import your files. The arguments of this function are:
</p><ul><li><p><span class="code">mytable</span>: The table to import the data in.
</p></li><li><p><span class="code">fileNames</span>: A list of file names (absolute file names including the full path) of the files you want to import. If <span class="code">CanAcceptMultipleFiles</span> is set to <span class="code">false</span> (in line 15)), then the list contains only one file name.
</p></li><li><p><span class="code">reporter</span>: Can be used to report the progress of the import, and to cancel the operation if the user presses the <span class="code">Cancel</span> button.
</p></li></ul></li><li><p>
Line 25 and 26: Before importing the data, the old contents of the data table is removed.
</p></li><li><p>
Line 27: Convenience function when importing only one file: The file name of the first file in the list of file names is put into variable <span class="code">fileName</span>.
</p></li><li><p>
Line 31-34: This is some default basis to build your own script on: A file stream is opened with the provided file name. After the comment in Line 33 you should do something with the stream. Typically, you will read data from the <span class="code">stream</span> and then put the data into the table <span class="code">mytable</span>.
</p></li></ul></div><hr /><div id="IDQABSection" class="collapsibleSection"><p>
Next section: <a href="B09D5D470B8DCF524A698117E51D308B.htm">Changing the structure of a worksheet</a></p></div></div></div><div id="PageFooter" class="pageFooter">Altaxo can be downloaded from <a href="https://sourceforge.net/projects/altaxo/files/Altaxo/">SourceForge</a>. Source code available on <a href="https://github.com/Altaxo/Altaxo">Github</a>.
<br /><a href="https://sourceforge.net/u/dlellinger/profile/">(C) Dr. Dirk Lellinger and all contributors to the source code 2002 - <script>document.write(new Date().getFullYear()); </script></a><div class="feedbackLink">Send comments on this topic to
        <a id="HT_MailLink" href="mailto:dlellinger%40users.sourceforge.net?Subject=Altaxo%20user%20manual%20and%20class%20reference">dlellinger@users.sourceforge.net</a></div>
        <script type="text/javascript">
        var HT_mailLink = document.getElementById("HT_MailLink");
        HT_mailLink.href += ": " + document.title + "\u0026body=" + encodeURIComponent("Your feedback is used to improve the documentation and the product. Your e-mail address will not be used for any other purpose and is disposed of after the issue you report is resolved. While working to resolve the issue that you report, you may be contacted via e-mail to get further details or clarification on the feedback you sent. After the issue you report has been addressed, you may receive an e-mail to let you know that your feedback has been addressed.");
        </script></div></body></html>