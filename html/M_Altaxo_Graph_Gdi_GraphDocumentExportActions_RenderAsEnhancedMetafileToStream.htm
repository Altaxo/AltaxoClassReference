<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"> </script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>GraphDocumentExportActions.RenderAsEnhancedMetafileToStream Method </title><meta name="Language" content="en-us" /><meta name="System.Keywords" content="RenderAsEnhancedMetafileToStream method" /><meta name="System.Keywords" content="GraphDocumentExportActions.RenderAsEnhancedMetafileToStream method" /><meta name="Microsoft.Help.F1" content="Altaxo.Graph.Gdi.GraphDocumentExportActions.RenderAsEnhancedMetafileToStream" /><meta name="Microsoft.Help.Id" content="M:Altaxo.Graph.Gdi.GraphDocumentExportActions.RenderAsEnhancedMetafileToStream(System.Action{System.Drawing.Graphics},System.IO.Stream,Altaxo.Geometry.PointD2D,System.Double,System.Double,System.Drawing.Imaging.PixelFormat)" /><meta name="Description" content="Renders a document as enhanced metafile. The metafile is rendered into a stream. You can create a metafile object afterwards from that stream." /><meta name="Microsoft.Help.ContentType" content="Reference" /><meta name="BrandingAware" content="true" /><meta name="container" content="Altaxo.Graph.Gdi" /><meta name="file" content="M_Altaxo_Graph_Gdi_GraphDocumentExportActions_RenderAsEnhancedMetafileToStream" /><meta name="guid" content="M_Altaxo_Graph_Gdi_GraphDocumentExportActions_RenderAsEnhancedMetafileToStream" /><link rel="stylesheet" type="text/css" href="../styles/branding-Website.css" /><script type="text/javascript" src="../scripts/jquery-1.11.0.min.js"></script><script type="text/javascript" src="../scripts/branding-Website.js"></script><script type="text/javascript" src="../scripts/clipboard.min.js"></script></head><body onload="OnLoad('cs')"><input type="hidden" id="userDataCache" class="userDataStyle" /><div class="pageHeader" id="PageHeader">Altaxo user manual and class reference<form id="SearchForm" method="get" action="#" onsubmit="javascript:TransferToSearchPage(); return false;"><input id="SearchTextBox" type="text" maxlength="200" /><button id="SearchButton" type="submit"></button></form></div><div class="pageBody"><div class="leftNav" id="leftNav"><div id="tocNav"><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html\1B7FE024E7E614BFA13DAA1FD005CB2E.htm" title="Altaxo user manual and class reference" tocid="roottoc">Altaxo user manual and class reference</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/R_Project_Documentation.htm" title="Altaxo class reference" tocid="R_Project_Documentation">Altaxo class reference</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/G_Altaxo.htm" title="Altaxo Namespaces" tocid="G_Altaxo">Altaxo Namespaces</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/G_Altaxo_Graph.htm" title="Altaxo.Graph Namespaces" tocid="G_Altaxo_Graph">Altaxo.Graph Namespaces</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/N_Altaxo_Graph_Gdi.htm" title="Altaxo.Graph.Gdi" tocid="N_Altaxo_Graph_Gdi">Altaxo.Graph.Gdi</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/T_Altaxo_Graph_Gdi_GraphDocumentExportActions.htm" title="GraphDocumentExportActions Class" tocid="T_Altaxo_Graph_Gdi_GraphDocumentExportActions">GraphDocumentExportActions Class</a></div><div class="toclevel1" data-toclevel="1" data-childrenloaded="true"><a class="tocExpanded" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/Methods_T_Altaxo_Graph_Gdi_GraphDocumentExportActions.htm" title="GraphDocumentExportActions Methods" tocid="Methods_T_Altaxo_Graph_Gdi_GraphDocumentExportActions">GraphDocumentExportActions Methods</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/M_Altaxo_Graph_Gdi_GraphDocumentExportActions_ConvertBitmapToPixelFormat.htm" title="ConvertBitmapToPixelFormat Method " tocid="M_Altaxo_Graph_Gdi_GraphDocumentExportActions_ConvertBitmapToPixelFormat">ConvertBitmapToPixelFormat Method </a></div><div class="toclevel2" data-toclevel="2"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/Overload_Altaxo_Graph_Gdi_GraphDocumentExportActions_RenderAsBitmap.htm" title="RenderAsBitmap Method " tocid="Overload_Altaxo_Graph_Gdi_GraphDocumentExportActions_RenderAsBitmap">RenderAsBitmap Method </a></div><div class="toclevel2" data-toclevel="2"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/Overload_Altaxo_Graph_Gdi_GraphDocumentExportActions_RenderAsBitmapToFile.htm" title="RenderAsBitmapToFile Method " tocid="Overload_Altaxo_Graph_Gdi_GraphDocumentExportActions_RenderAsBitmapToFile">RenderAsBitmapToFile Method </a></div><div class="toclevel2" data-toclevel="2"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/Overload_Altaxo_Graph_Gdi_GraphDocumentExportActions_RenderAsBitmapToStream.htm" title="RenderAsBitmapToStream Method " tocid="Overload_Altaxo_Graph_Gdi_GraphDocumentExportActions_RenderAsBitmapToStream">RenderAsBitmapToStream Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/M_Altaxo_Graph_Gdi_GraphDocumentExportActions_RenderAsEnhancedMetafile.htm" title="RenderAsEnhancedMetafile Method " tocid="M_Altaxo_Graph_Gdi_GraphDocumentExportActions_RenderAsEnhancedMetafile">RenderAsEnhancedMetafile Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/M_Altaxo_Graph_Gdi_GraphDocumentExportActions_RenderAsEnhancedMetafileBitmapFormat.htm" title="RenderAsEnhancedMetafileBitmapFormat Method " tocid="M_Altaxo_Graph_Gdi_GraphDocumentExportActions_RenderAsEnhancedMetafileBitmapFormat">RenderAsEnhancedMetafileBitmapFormat Method </a></div><div class="toclevel2 current" data-toclevel="2"><a data-tochassubtree="false" href="../html/M_Altaxo_Graph_Gdi_GraphDocumentExportActions_RenderAsEnhancedMetafileToStream.htm" title="RenderAsEnhancedMetafileToStream Method " tocid="M_Altaxo_Graph_Gdi_GraphDocumentExportActions_RenderAsEnhancedMetafileToStream">RenderAsEnhancedMetafileToStream Method </a></div><div class="toclevel2" data-toclevel="2"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/Overload_Altaxo_Graph_Gdi_GraphDocumentExportActions_RenderAsEnhancedMetafileVectorFormat.htm" title="RenderAsEnhancedMetafileVectorFormat Method " tocid="Overload_Altaxo_Graph_Gdi_GraphDocumentExportActions_RenderAsEnhancedMetafileVectorFormat">RenderAsEnhancedMetafileVectorFormat Method </a></div><div class="toclevel2" data-toclevel="2"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/Overload_Altaxo_Graph_Gdi_GraphDocumentExportActions_RenderAsEnhancedMetafileVectorFormatToStream.htm" title="RenderAsEnhancedMetafileVectorFormatToStream Method " tocid="Overload_Altaxo_Graph_Gdi_GraphDocumentExportActions_RenderAsEnhancedMetafileVectorFormatToStream">RenderAsEnhancedMetafileVectorFormatToStream Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/M_Altaxo_Graph_Gdi_GraphDocumentExportActions_RenderToFile.htm" title="RenderToFile Method " tocid="M_Altaxo_Graph_Gdi_GraphDocumentExportActions_RenderToFile">RenderToFile Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/M_Altaxo_Graph_Gdi_GraphDocumentExportActions_RenderToStream.htm" title="RenderToStream Method " tocid="M_Altaxo_Graph_Gdi_GraphDocumentExportActions_RenderToStream">RenderToStream Method </a></div></div><div id="tocResizableEW" onmousedown="OnMouseDown(event);"></div><div id="TocResize" class="tocResize"><img id="ResizeImageIncrease" src="../icons/TocOpen.gif" onclick="OnIncreaseToc()" alt="Click or drag to resize" title="Click or drag to resize" /><img id="ResizeImageReset" src="../icons/TocClose.gif" style="display:none" onclick="OnResetToc()" alt="Click or drag to resize" title="Click or drag to resize" /></div></div><div class="topicContent" id="TopicContent"><table class="titleTable"><tr><td class="titleColumn"><h1>GraphDocumentExportActions<span id="LST4E65E91C_0"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST4E65E91C_0?cpp=::|nu=.");</script>RenderAsEnhancedMetafileToStream Method </h1></td></tr></table><span class="introStyle"></span> <div class="summary">
            Renders a document as enhanced metafile. The metafile is rendered into a stream. You can create a metafile object afterwards from that stream.
            </div><p> </p>
    <strong>Namespace:</strong> 
   <a href="N_Altaxo_Graph_Gdi.htm">Altaxo.Graph.Gdi</a><br />
    <strong>Assembly:</strong>
   AltaxoBase (in AltaxoBase.dll) Version: 4.7.1867.0 (4.7.1867.0)<div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID1RB')" onkeypress="SectionExpandCollapse_CheckKey('ID1RB', event)" tabindex="0"><img id="ID1RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Syntax</span></div><div id="ID1RBSection" class="collapsibleSection"><div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID0EACA_tab1" class="codeSnippetContainerTabSingle">C#</div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID0EACA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID0EACA');return false;" title="Copy">Copy</a></div></div><div id="ID0EACA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="identifier">RenderAsEnhancedMetafileToStream</span>(
	<span class="identifier">Action</span>&lt;<span class="identifier">Graphics</span>&gt; <span class="parameter">renderingProc</span>,
	<span class="identifier">Stream</span> <span class="parameter">stream</span>,
	<span class="identifier">PointD2D</span> <span class="parameter">docSize</span>,
	<span class="identifier">double</span> <span class="parameter">sourceDpiResolution</span>,
	<span class="identifier">double</span> <span class="parameter">outputScalingFactor</span>,
	<span class="identifier">PixelFormat</span> <span class="parameter">pixelFormat</span> = <span class="identifier">PixelFormat</span>.Format32bppArgb
)</pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0EACA");</script><h4 class="subHeading">Parameters</h4><dl><dt><span class="parameter">renderingProc</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/018hxwa8" target="_blank">System<span id="LST4E65E91C_1"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST4E65E91C_1?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Action</a><span id="LST4E65E91C_2"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST4E65E91C_2?cs=&lt;|vb=(Of |cpp=&lt;|fs=&lt;'|nu=(");</script><a href="http://msdn2.microsoft.com/en-us/library/ac148eb3" target="_blank">Graphics</a><span id="LST4E65E91C_3"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST4E65E91C_3?cs=&gt;|vb=)|cpp=&gt;|fs=&gt;|nu=)");</script><br />Procedure for rendering the document.
            The argument is a graphics context, which is set to GraphicsUnits equal to Points.
            The drawing must be inside of the boundaries of docSize.X and docSize.Y.
            </dd><dt><span class="parameter">stream</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/8f86tw9e" target="_blank">System.IO<span id="LST4E65E91C_4"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST4E65E91C_4?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Stream</a><br />Destination stream. The metafile is rendered into this stream. The stream has to be writeable and seekable. At return, the position of the stream is set to 0, thus the stream is ready to be used to create a metafile object from it.</dd><dt><span class="parameter">docSize</span></dt><dd>Type: <a href="T_Altaxo_Geometry_PointD2D.htm">Altaxo.Geometry<span id="LST4E65E91C_5"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST4E65E91C_5?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>PointD2D</a><br />Size of the document in points (1/72 inch)</dd><dt><span class="parameter">sourceDpiResolution</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/643eft0t" target="_blank">System<span id="LST4E65E91C_6"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST4E65E91C_6?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Double</a><br />The resolution in dpi of the source. This parameter is used only if creating the reference graphics context from the current printer fails. In this case, a context from a bitmap with the provided resolution is created.</dd><dt><span class="parameter">outputScalingFactor</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/643eft0t" target="_blank">System<span id="LST4E65E91C_7"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST4E65E91C_7?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Double</a><br />Output scaling factor. If less than 1, the image will appear smaller than originally, if greater than 1, the image will appear larger than originally.</dd><dt><span class="parameter">pixelFormat</span> (Optional)</dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/wy8w9t0s" target="_blank">System.Drawing.Imaging<span id="LST4E65E91C_8"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST4E65E91C_8?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>PixelFormat</a><br />Optional: Only used if the graphics context can not be created from a printer document. Pixel format of the bitmap that is used in this case to construct the graphics context.</dd></dl><h4 class="subHeading">Return Value</h4>Type: <br />The rendered enhanced metafile (vector format).</div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID2RB')" onkeypress="SectionExpandCollapse_CheckKey('ID2RB', event)" tabindex="0"><img id="ID2RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Remarks</span></div><div id="ID2RBSection" class="collapsibleSection"><p>
            I found no other way to realize different dpi resolutions, independently of screen or printer device contexts, as to patch the resulting metafile stream with
            informations about an 'artifical' device, which has exactly the resolution that is neccessary. By careful choice of the size of this artifical device one can
            avoid rounding errors concerning resolution and size.
            It happens that some programs (for instance MS Word 2010 when saving as PDF document) mess up the size of the metafile graphics, if the graphics was created with a PageUnit
            (of the graphics context) other than PIXELS.
            Thus I now always use PIXEL as PageUnit and scale the graphics context accordingly.
            </p><p>
            Another problem, which is actually without solution, is that e.g. MS Office will not show polylines with more than 8125 points. These polylines are included in the metafile,
            but MS Office seems to ignore them. On the other hand, CorelDraw X5 can show these polylines correctly.
            This problem might be related to the EmfPlus format, because MS Office will show these polylines if the EmfOnly format is used. But EmfOnly can not handle transparencies, thus
            it is not really a choice.
            </p></div><div class="collapsibleAreaRegion" id="seeAlsoSection"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID3RB')" onkeypress="SectionExpandCollapse_CheckKey('ID3RB', event)" tabindex="0"><img id="ID3RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />See Also</span></div><div id="ID3RBSection" class="collapsibleSection"><h4 class="subHeading">Reference</h4><div class="seeAlsoStyle"><a href="T_Altaxo_Graph_Gdi_GraphDocumentExportActions.htm">GraphDocumentExportActions Class</a></div><div class="seeAlsoStyle"><a href="N_Altaxo_Graph_Gdi.htm">Altaxo.Graph.Gdi Namespace</a></div></div></div></div><div id="pageFooter" class="pageFooter">Altaxo can be downloaded from <a href="https://sourceforge.net/projects/altaxo/files/Altaxo/">SourceForge</a>. Source code available on <a href="https://github.com/Altaxo/Altaxo">Github</a>.<p><a href="https://sourceforge.net/u/dlellinger/profile/" target="_blank">(C) Dr. Dirk Lellinger 2002 - 2018</a></p><div class="feedbackLink">Send comments on this topic to
        <a id="HT_MailLink" href="mailto:dlellinger%40users.sourceforge.net?Subject=Altaxo user manual and class reference">dlellinger@users.sourceforge.net</a></div>
        <script type="text/javascript">
        var HT_mailLink = document.getElementById("HT_MailLink");
        var HT_mailLinkText = HT_mailLink.innerHTML;
        HT_mailLink.href += ": " + document.title + "\u0026body=" + encodeURIComponent("Your feedback is used to improve the documentation and the product. Your e-mail address will not be used for any other purpose and is disposed of after the issue you report is resolved. While working to resolve the issue that you report, you may be contacted via e-mail to get further details or clarification on the feedback you sent. After the issue you report has been addressed, you may receive an e-mail to let you know that your feedback has been addressed.");
        HT_mailLink.innerHTML = HT_mailLinkText;
        </script> </div></body></html>