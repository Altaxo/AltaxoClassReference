<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="Microsoft.Help.SelfBranded" content="true" /><meta name="Language" content="en-us" /><meta name="Microsoft.Help.Locale" content="en-us" /><meta name="Microsoft.Help.TopicLocale" content="en-us" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"></script><title>Changing the structure of a worksheet</title><meta name="Microsoft.Help.Id" content="B09D5D470B8DCF524A698117E51D308B" /><meta name="Microsoft.Help.ContentType" content="Concepts" /><meta name="Description" content="Previous section: Importing ASCII data" /><link rel="stylesheet" type="text/css" href="../styles/branding-Website.css" /><script type="text/javascript" src="../scripts/jquery-3.5.1.min.js"></script><script type="text/javascript" src="../scripts/branding-Website.js"></script><script type="text/javascript" src="../scripts/clipboard.min.js"></script></head><body onload="SetDefaultLanguage('cs');"><input type="hidden" id="userDataCache" class="userDataStyle" /><div id="PageHeader" class="pageHeader">Altaxo user manual and class reference<form id="SearchForm" method="get" action="#" onsubmit="TransferToSearchPage(); return false;"><input id="SearchTextBox" type="text" maxlength="200" /><button id="SearchButton" type="submit"></button></form></div><div class="pageBody"><div class="leftNav" id="leftNav"><div id="tocNav"><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/1B7FE024E7E614BFA13DAA1FD005CB2E.htm" title="Altaxo user manual and class reference" tocid="roottoc">Altaxo user manual and class reference</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/1B7FE024E7E614BFA13DAA1FD005CB2E.htm" title="Altaxo user manual" tocid="1B7FE024E7E614BFA13DAA1FD005CB2E">Altaxo user manual</a></div><div class="toclevel1" data-toclevel="1" data-childrenloaded="true"><a class="tocExpanded" onclick="Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/345E05B54F4611736070E46B38DD4CB5.htm" title="Tables and Worksheets" tocid="345E05B54F4611736070E46B38DD4CB5">Tables and Worksheets</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/5C8543F24C7EE1C52CD7211AC31DB592.htm" title="Data columns and property columns" tocid="5C8543F24C7EE1C52CD7211AC31DB592">Data columns and property columns</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/AA57528103751EB21A179BF18C6C5F58.htm" title="Column headers" tocid="AA57528103751EB21A179BF18C6C5F58">Column headers</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/6FAC01304D7EC3D8AE1C724CA084256B.htm" title="Creating a new worksheet" tocid="6FAC01304D7EC3D8AE1C724CA084256B">Creating a new worksheet</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/0F56118543F36CC6A6EB223F48A5B2C2.htm" title="Creating additional data columns or property columns" tocid="0F56118543F36CC6A6EB223F48A5B2C2">Creating additional data columns or property columns</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/9EC02FDB23AEF02047503483B7079F28.htm" title="Selection of columns and/or rows in a worksheet" tocid="9EC02FDB23AEF02047503483B7079F28">Selection of columns and/or rows in a worksheet</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/F71D3901373F20479F4C3575F2838494.htm" title="Copy/paste of worksheet data" tocid="F71D3901373F20479F4C3575F2838494">Copy/paste of worksheet data</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/CCE945B2EC2C578D8C49120D55FACEE3.htm" title="Importing ASCII data" tocid="CCE945B2EC2C578D8C49120D55FACEE3">Importing ASCII data</a></div><div class="toclevel2 current" data-toclevel="2"><a data-tochassubtree="false" href="../html/B09D5D470B8DCF524A698117E51D308B.htm" title="Changing the structure of a worksheet" tocid="B09D5D470B8DCF524A698117E51D308B">Changing the structure of a worksheet</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/742EC350D96B6D65DA918DE77373E534.htm" title="Worksheet Notes" tocid="742EC350D96B6D65DA918DE77373E534">Worksheet Notes</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/51AB2CB3ECBAFD1DD0F029C0B45B8046.htm" title="Worksheet Scripts and Column Scripts" tocid="51AB2CB3ECBAFD1DD0F029C0B45B8046">Worksheet Scripts and Column Scripts</a></div></div><div id="tocResizableEW" onmousedown="OnMouseDown(event);"></div><div id="TocResize" class="tocResize"><img id="ResizeImageIncrease" src="../icons/TocOpen.gif" onclick="OnIncreaseToc()" alt="Click or drag to resize" title="Click or drag to resize" /><img id="ResizeImageReset" src="../icons/TocClose.gif" style="display:none" onclick="OnResetToc()" alt="Click or drag to resize" title="Click or drag to resize" /></div></div><div id="TopicContent" class="topicContent"><table class="titleTable"><tr><td class="titleColumn"><h1>Changing the structure of a worksheet</h1></td></tr></table><div><p>
Previous section: <a href="CCE945B2EC2C578D8C49120D55FACEE3.htm">Importing ASCII data</a></p><p>This topic contains the following sections:</p><ul><li><a href="#F30A8388D1325EC508BCF6A76CC69D49">Transposing a worksheet</a></li><li><a href="#BDC77858E7B184C7E5436C5CFB9673E7">Decompose a table with a cycling independent variable</a></li><li><a href="#CB52FC32CFE755AF5F63685529828624">Convert X-Y-V columns to a matrix</a></li></ul><hr /></div><div class="collapsibleAreaRegion" id="F30A8388D1325EC508BCF6A76CC69D49"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDBAB')" onkeypress="SectionExpandCollapse_CheckKey('IDBAB', event)" tabindex="0"><img id="IDBABToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Transposing a worksheet</span></div><div id="IDBABSection" class="collapsibleSection"><p>
Sometimes it is necessary to exchange data rows and data columns. This
operation is called transposing a table. To do it, make the worksheet
you want to transpose the active document and then choose
Worksheet→Restructure Worksheet data→Transpose from the main
menu. A dialog opens (see figure below).
</p><p><span class="mediaInline"><img alt="FDADB0208290E6CBA531212161BD248C" src="../media/FDADB0208290E6CBA531212161BD248C.png" /></span></p><p>
You can specify the number of data columns to convert to property
columns, and you can specify the number of property columns that will be
converted to data columns. If you want to do only a simple transpose of
all data columns, set both numbers to zero.
</p><p>
The figure below shows a worksheet before (left side) and after
transposing (right side), choosing one data column to convert into a
property column and two property columns to convert into data columns.
Note that in this worksheet all data columns and property columns of
type TextColumn.
</p><p><span class="mediaInline"><img alt="287BFF7B6229CFF1E16BBCACF21B6118" src="../media/287BFF7B6229CFF1E16BBCACF21B6118.png" /></span></p><p>
The one data column that is converted to a property column is marked
green. The two property columns which become data columns are marked
with blue and purple. The other data rows (I have marked only column 1
and 2 become data rows in the transposed worksheet.
</p><p>
Please note that transposing a worksheet works best if all columns are
of the same type. Otherwise some loss of data can not be avoided.
</p></div><div class="collapsibleAreaRegion" id="BDC77858E7B184C7E5436C5CFB9673E7"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDCAB')" onkeypress="SectionExpandCollapse_CheckKey('IDCAB', event)" tabindex="0"><img id="IDCABToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Decompose a table with a cycling independent variable</span></div><div id="IDCABSection" class="collapsibleSection"><p>
Consider the following worksheet:
</p><p><span class="mediaInline"><img alt="51E626A668CD6DC280E60F4EA92E09CA" src="../media/51E626A668CD6DC280E60F4EA92E09CA.png" /></span></p><p>
This data could have been produced by a measurement device, varying the
measurement frequency (data column 0), and the temperature (column 1).
The measured values are the real and imaginary part of the modulus in columns
2 and 3.
</p><p>
Obviously, in the given form, if you try to plot the data (Modulus.Re)
versus frequency, you will get a scrambled result:
</p><p><span class="mediaInline"><img alt="D4FB4691D1D2EACDE7FA5778D881480F" src="../media/D4FB4691D1D2EACDE7FA5778D881480F.png" /></span></p><p>
This is because the frequency is repeated three times: (1, 10, 100, 1,
100, 100 and so on). I call the frequency here ‘cycling independent variable’
because it cycles between a set of values (1, 10, 100).
</p><p>
What you really need are separate columns for the modulus, one for each
temperature (if you want to plot modulus versus frequency), or one for
each frequency (if you want to plot modulus versus temperature).
</p><p>
If you have separate columns of the modulus for each temperature, you
can plot them much more nicely that in the example above. Furthermore,
you can show the temperatures that belong to each column in the legend:
</p><p><span class="mediaInline"><img alt="61BD6B063E0DE43CCCA7FA4ECE5A855D" src="../media/61BD6B063E0DE43CCCA7FA4ECE5A855D.png" /></span></p><p>
This kind of restructuring can be achieved with the command:
</p><p>
Worksheet→<strong>Restructure Worksheet data</strong>→Decompose table with
cycling indep. Var'''
</p><p>
from the main menu.
</p><p>
Before you issue this command, select all columns that you want to have
in the new worksheet, including the cycling variable (here: Frequency)
and the second independent variable (here: Temperature).
</p><p>
For the next examples, I had always selected all four datacolumns in the
original worksheet.
</p><p>
A dialog appears:
</p><p><span class="mediaInline"><img alt="CF5BFABEFB0D24A7E3967B7B76E8144E" src="../media/CF5BFABEFB0D24A7E3967B7B76E8144E.png" /></span></p><p>
Make sure that the column with the cycling variable is selected in the
first combo box. In the list box labeled ‘Columns to average over one
repeat period’ you should select the second independent variable, which
here is the column ‘Temperature’. The next choice (‘Destination output’)
is about how to group the remaining columns in the destination
worksheet. ‘Destination X’ let you choose the cycling variable as the
new x-column (here: if you want to plot modulus versus frequency), or
the first averaged column (here: if you want to plot modulus versus
temperature). The remaining options concern the sorting of the columns
and rows in the destination worksheet and should be self-explanatory.
</p><p>
With the data above, I chose ‘GroupOneColumn’ for destination output and
‘CyclingVariable’ for Destination X (see figure below).
</p><p><span class="mediaInline"><img alt="C9532F1588D0F4B1A675340B957C421F" src="../media/C9532F1588D0F4B1A675340B957C421F.png" /></span></p><p>
The resulting worksheet look like this:
</p><p><span class="mediaInline"><img alt="3DF2573DD8057A3011F1273F1899EFE4" src="../media/3DF2573DD8057A3011F1273F1899EFE4.png" /></span></p><p>
As you can see, ‘Frequency’ is the X-column of the resulting worksheet,
and this column no longer contains repeated values. The temperature has
become a property of the other columns; it is now a property
column. By the option ‘GroupOneColumn’ first the three ‘Modulus.Re’
columns appear in the new worksheet, and then the three ‘Modulus.Im’
columns, one column for each temperature (to be exactly: for each
cycle of the frequency).
</p><p>
In contrast to that, consider the following options:
</p><p><span class="mediaInline"><img alt="695431ED3087DE3959FB49B4C12800AC" src="../media/695431ED3087DE3959FB49B4C12800AC.png" /></span></p><p>
Here I have chosen ‘GroupAllColumns’ for destination output and
‘FirstAveragedColumn’ for Destination X. The outcome of this options is:
</p><p><span class="mediaInline"><img alt="0E4901DD95532E8B52A44F4E2456E5FC" src="../media/0E4901DD95532E8B52A44F4E2456E5FC.png" /></span></p><p>
As you can see, now ‘Temperature’ is the x-column of the resulting
worksheet. The frequency has become a property of the other columns,
since it is now a property column. By the option ‘GroupAllColumn’ all
other columns (Modulus.Re and Modulus.Im) are repeated for the first
frequency (1), then for the next frequency (10), and finally for the
last frequency (100).
</p></div><div class="collapsibleAreaRegion" id="CB52FC32CFE755AF5F63685529828624"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDDAB')" onkeypress="SectionExpandCollapse_CheckKey('IDDAB', event)" tabindex="0"><img id="IDDABToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Convert X-Y-V columns to a matrix</span></div><div id="IDDABSection" class="collapsibleSection"><p>
Consider the following worksheet from the previous chapter:
</p><p><span class="mediaInline"><img alt="1DB3D9952DE94BA0ADB0B490ACD63510" src="../media/1DB3D9952DE94BA0ADB0B490ACD63510.png" /></span></p><p>
Note that I here marked column 1 (‘Temperature’) as y-column (by using
Column→Set column as Y from the main menu). Then I selected column
‘Frequency’ (x-column), column ‘Temperature’ (y-column) and column
‘Modulus.Re’ (V-column).
</p><p>
After using Worksheet→Restructure Worksheet data→Convert X-Y-V
to matrix the following worksheet results:
</p><p><span class="mediaInline"><img alt="F4DEB8301D15683A266AEBF66057DF8D" src="../media/F4DEB8301D15683A266AEBF66057DF8D.png" /></span></p><p>
As you can see, the Modulus.Re values are arranged ‘matrix-like’ in
columns 1, 2 and 3. The x-column is still column 0 (‘Frequency’). And
the former y-column ‘Temperature’ has become a property column with the
same name. You can use such a ‘matrix-like’ worksheet for instance to
make a density plot.
</p></div><hr /><div id="IDFABSection" class="collapsibleSection"><p>
Next section: <a href="742EC350D96B6D65DA918DE77373E534.htm">Worksheet Notes</a></p></div></div></div><div id="PageFooter" class="pageFooter">Altaxo can be downloaded from <a href="https://sourceforge.net/projects/altaxo/files/Altaxo/">SourceForge</a>. Source code available on <a href="https://github.com/Altaxo/Altaxo">Github</a>.
<br /><a href="https://sourceforge.net/u/dlellinger/profile/">(C) Dr. Dirk Lellinger and all contributors to the source code 2002 - <script>document.write(new Date().getFullYear()); </script></a><div class="feedbackLink">Send comments on this topic to
        <a id="HT_MailLink" href="mailto:dlellinger%40users.sourceforge.net?Subject=Altaxo%20user%20manual%20and%20class%20reference">dlellinger@users.sourceforge.net</a></div>
        <script type="text/javascript">
        var HT_mailLink = document.getElementById("HT_MailLink");
        HT_mailLink.href += ": " + document.title + "\u0026body=" + encodeURIComponent("Your feedback is used to improve the documentation and the product. Your e-mail address will not be used for any other purpose and is disposed of after the issue you report is resolved. While working to resolve the issue that you report, you may be contacted via e-mail to get further details or clarification on the feedback you sent. After the issue you report has been addressed, you may receive an e-mail to let you know that your feedback has been addressed.");
        </script></div></body></html>