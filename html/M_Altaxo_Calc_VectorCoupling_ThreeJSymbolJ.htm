<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="Microsoft.Help.SelfBranded" content="true" /><meta name="Language" content="en-us" /><meta name="Microsoft.Help.Locale" content="en-us" /><meta name="Microsoft.Help.TopicLocale" content="en-us" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"></script><title>VectorCoupling.ThreeJSymbolJ Method</title><meta name="Title" content="ThreeJSymbolJ Method" /><meta name="Microsoft.Help.Id" content="M:Altaxo.Calc.VectorCoupling.ThreeJSymbolJ(System.Double,System.Double,System.Double,System.Double,System.Double@,System.Double@,System.Double[],System.Int32,System.Int32@)" /><meta name="Microsoft.Help.ContentType" content="Reference" /><meta name="System.Keywords" content="VectorCoupling.ThreeJSymbolJ method" /><meta name="System.Keywords" content="ThreeJSymbolJ method" /><meta name="Microsoft.Help.F1" content="Altaxo.Calc.VectorCoupling.ThreeJSymbolJ" /><meta name="Microsoft.Help.F1" content="VectorCoupling.ThreeJSymbolJ" /><meta name="Microsoft.Help.F1" content="ThreeJSymbolJ" /><meta name="container" content="Altaxo.Calc" /><meta name="file" content="M_Altaxo_Calc_VectorCoupling_ThreeJSymbolJ" /><meta name="guid" content="M_Altaxo_Calc_VectorCoupling_ThreeJSymbolJ" /><meta name="Microsoft.Help.Category" content="CSharp" /><meta name="Description" content="Evaluate the Wigner 3j symbol @@_SHFB_1 for all allowed values of l1, the other parameters being held fixed." /><link type="text/css" rel="stylesheet" href="../styles/highlight.css" /><script type="text/javascript" src="../scripts/highlight.js"> </script><link rel="stylesheet" type="text/css" href="../styles/branding-Website.css" /><script type="text/javascript" src="../scripts/jquery-3.5.1.min.js"></script><script type="text/javascript" src="../scripts/branding-Website.js"></script><script type="text/javascript" src="../scripts/clipboard.min.js"></script></head><body onload="SetDefaultLanguage('cs');"><input type="hidden" id="userDataCache" class="userDataStyle" /><div id="PageHeader" class="pageHeader">Altaxo user manual and class reference<form id="SearchForm" method="get" action="#" onsubmit="TransferToSearchPage(); return false;"><input id="SearchTextBox" type="text" maxlength="200" /><button id="SearchButton" type="submit"></button></form></div><div class="pageBody"><div class="leftNav" id="leftNav"><div id="tocNav"><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/1B7FE024E7E614BFA13DAA1FD005CB2E.htm" title="Altaxo user manual and class reference" tocid="roottoc">Altaxo user manual and class reference</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/R_Project_Documentation.htm" title="Altaxo class reference" tocid="R_Project_Documentation">Altaxo class reference</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/G_Altaxo.htm" title="Altaxo Namespaces" tocid="G_Altaxo">Altaxo Namespaces</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/G_Altaxo_Calc.htm" title="Altaxo.Calc Namespaces" tocid="G_Altaxo_Calc">Altaxo.Calc Namespaces</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/N_Altaxo_Calc.htm" title="Altaxo.Calc" tocid="N_Altaxo_Calc">Altaxo.Calc</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/T_Altaxo_Calc_VectorCoupling.htm" title="VectorCoupling Class" tocid="T_Altaxo_Calc_VectorCoupling">VectorCoupling Class</a></div><div class="toclevel1" data-toclevel="1" data-childrenloaded="true"><a class="tocExpanded" onclick="Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/Methods_T_Altaxo_Calc_VectorCoupling.htm" title="VectorCoupling Methods" tocid="Methods_T_Altaxo_Calc_VectorCoupling">VectorCoupling Methods</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/M_Altaxo_Calc_VectorCoupling_ClebschGordan.htm" title="ClebschGordan Method" tocid="M_Altaxo_Calc_VectorCoupling_ClebschGordan">ClebschGordan Method</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/M_Altaxo_Calc_VectorCoupling_SixJSymbol.htm" title="SixJSymbol Method" tocid="M_Altaxo_Calc_VectorCoupling_SixJSymbol">SixJSymbol Method</a></div><div class="toclevel2 current" data-toclevel="2"><a data-tochassubtree="false" href="../html/M_Altaxo_Calc_VectorCoupling_ThreeJSymbolJ.htm" title="ThreeJSymbolJ Method" tocid="M_Altaxo_Calc_VectorCoupling_ThreeJSymbolJ">ThreeJSymbolJ Method</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/M_Altaxo_Calc_VectorCoupling_ThreeJSymbolM.htm" title="ThreeJSymbolM Method" tocid="M_Altaxo_Calc_VectorCoupling_ThreeJSymbolM">ThreeJSymbolM Method</a></div></div><div id="tocResizableEW" onmousedown="OnMouseDown(event);"></div><div id="TocResize" class="tocResize"><img id="ResizeImageIncrease" src="../icons/TocOpen.gif" onclick="OnIncreaseToc()" alt="Click or drag to resize" title="Click or drag to resize" /><img id="ResizeImageReset" src="../icons/TocClose.gif" style="display:none" onclick="OnResetToc()" alt="Click or drag to resize" title="Click or drag to resize" /></div></div><div id="TopicContent" class="topicContent"><table class="titleTable"><tr><td class="titleColumn"><h1>Vector<wbr />Coupling<span id="LST22087A19_0" data-languageSpecificText="cpp=::|nu=."></span>Three<wbr />JSymbol<wbr />J Method</h1></td></tr></table><div class="summary">
             Evaluate the Wigner 3j symbol
             <div id="IDBAC" class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="IDBAC_tab1" class="codeSnippetContainerTabSingle">C#</div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="IDBAC_copyCode" href="#" class="copyCodeSnippet" onclick="CopyToClipboard('IDBAC');return false;" title="Copy">Copy</a></div></div><div id="IDBAC_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve">f(l1) = (   l1    l2   l3 )
        ( -m2-m3  m2   m3 )</pre></div></div></div>
             for all allowed values of l1, the other parameters being held fixed.
             </div><br /><strong>Namespace:</strong> <a href="N_Altaxo_Calc.htm">Altaxo.Calc</a><br /><strong>Assembly:</strong> AltaxoCore (in AltaxoCore.dll) Version: 4.8.3261.0 (4.8.3261.0)<div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDB')" onkeypress="SectionExpandCollapse_CheckKey('IDB', event)" tabindex="0"><img id="IDBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Syntax</span></div><div id="IDBSection" class="collapsibleSection"><div id="IDAB" class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="IDAB_tab1" class="codeSnippetContainerTabSingle">C#</div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="IDAB_copyCode" href="#" class="copyCodeSnippet" onclick="CopyToClipboard('IDAB');return false;" title="Copy">Copy</a></div></div><div id="IDAB_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="identifier">ThreeJSymbolJ</span>(
	<span class="identifier">double</span> <span class="parameter">l2</span>,
	<span class="identifier">double</span> <span class="parameter">l3</span>,
	<span class="identifier">double</span> <span class="parameter">m2</span>,
	<span class="identifier">double</span> <span class="parameter">m3</span>,
	<span class="keyword">out</span> <span class="identifier">double</span> <span class="parameter">l1min</span>,
	<span class="keyword">out</span> <span class="identifier">double</span> <span class="parameter">l1max</span>,
	<span class="identifier">double</span>[] <span class="parameter">thrcof</span>,
	<span class="identifier">int</span> <span class="parameter">ndim</span>,
	<span class="keyword">out</span> <span class="identifier">int</span> <span class="parameter">errflag</span>
)</pre></div></div></div><h4>Parameters</h4><dl><dt class="has-text-weight-normal"><span class="parameter">l2</span>  <a href="https://learn.microsoft.com/dotnet/api/system.double" target="_blank" rel="noopener noreferrer">Double</a></dt><dd>Parameter in 3j symbol.</dd><dt class="has-text-weight-normal"><span class="parameter">l3</span>  <a href="https://learn.microsoft.com/dotnet/api/system.double" target="_blank" rel="noopener noreferrer">Double</a></dt><dd>Parameter in 3j symbol.</dd><dt class="has-text-weight-normal"><span class="parameter">m2</span>  <a href="https://learn.microsoft.com/dotnet/api/system.double" target="_blank" rel="noopener noreferrer">Double</a></dt><dd>Parameter in 3j symbol.</dd><dt class="has-text-weight-normal"><span class="parameter">m3</span>  <a href="https://learn.microsoft.com/dotnet/api/system.double" target="_blank" rel="noopener noreferrer">Double</a></dt><dd>Parameter in 3j symbol.</dd><dt class="has-text-weight-normal"><span class="parameter">l1min</span>  <a href="https://learn.microsoft.com/dotnet/api/system.double" target="_blank" rel="noopener noreferrer">Double</a><span id="LST22087A19_1" data-languageSpecificText="cpp=%"></span></dt><dd>Smallest allowable l1 in 3j symbol.</dd><dt class="has-text-weight-normal"><span class="parameter">l1max</span>  <a href="https://learn.microsoft.com/dotnet/api/system.double" target="_blank" rel="noopener noreferrer">Double</a><span id="LST22087A19_2" data-languageSpecificText="cpp=%"></span></dt><dd>Largest allowable l1 in 3j symbol.</dd><dt class="has-text-weight-normal"><span class="parameter">thrcof</span>  <span id="LST22087A19_3" data-languageSpecificText="cpp=array&lt;"></span><a href="https://learn.microsoft.com/dotnet/api/system.double" target="_blank" rel="noopener noreferrer">Double</a><span id="LST22087A19_4" data-languageSpecificText="cpp=&gt;|vb=()|nu=[]"></span></dt><dd>Set of 3j coefficients generated by evaluating the
                  3j symbol for all allowed values of l1.
                  thrcof(i) will contain f(l1min+i),
                  for i = 0, 2, ... , l1max+l1min.
             </dd><dt class="has-text-weight-normal"><span class="parameter">ndim</span>  <a href="https://learn.microsoft.com/dotnet/api/system.int32" target="_blank" rel="noopener noreferrer">Int32</a></dt><dd>Declared length of thrcof in calling program.</dd><dt class="has-text-weight-normal"><span class="parameter">errflag</span>  <a href="https://learn.microsoft.com/dotnet/api/system.int32" target="_blank" rel="noopener noreferrer">Int32</a><span id="LST22087A19_5" data-languageSpecificText="cpp=%"></span></dt><dd><p>errflag=0  No errors.</p><p>errflag=1  Either l2 &lt; abs(m2) or l3 &lt; abs(m3).</p><p>errflag=2  Either l2+abs(m2) or l3+abs(m3) non-integer.</p><p>errflag=3  l1max-l1min not an integer.</p><p>errflag=4  l1max less than l1min.</p><p>errflag=5  ndim less than l1max-l1min+1.</p></dd></dl></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDKC')" onkeypress="SectionExpandCollapse_CheckKey('IDKC', event)" tabindex="0"><img id="IDKCToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Remarks</span></div><div id="IDKCSection" class="collapsibleSection"><div id="IDAKC" class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="IDAKC_tab1" class="codeSnippetContainerTabSingle">C#</div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="IDAKC_copyCode" href="#" class="copyCodeSnippet" onclick="CopyToClipboard('IDAKC');return false;" title="Copy">Copy</a></div></div><div id="IDAKC_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve">Description:
------------

Although conventionally the parameters of the vector addition
coefficients satisfy certain restrictions, such <span class="highlight-keyword">as</span> being integers
or integers plus <span class="highlight-number">1</span>/<span class="highlight-number">2</span>, the restrictions imposed <span class="highlight-keyword">on</span> input to <span class="highlight-keyword">this</span>
subroutine are somewhat weaker. See, <span class="highlight-keyword">for</span> example, Section <span class="highlight-number">27.9</span> of
Abramowitz and Stegun or Appendix C of Volume II of A. Messiah.

The restrictions imposed by <span class="highlight-keyword">this</span> subroutine are

      <span class="highlight-number">1</span>. l2 &gt;= abs(m2) and l3 &gt;= abs(m3)
      <span class="highlight-number">2</span>. l2+abs(m2) and l3+abs(m3) must be integers
      <span class="highlight-number">3</span>. l1max-l1min must be a non-negative integer, <span class="highlight-keyword">where</span>
         l1max=l2+l3 and l1min=max(abs(l2-l3),abs(m2+m3))

If the conventional restrictions are satisfied, then these
restrictions are also met.

The user should be cautious <span class="highlight-keyword">in</span> <span class="highlight-keyword">using</span> input parameters that <span class="highlight-keyword">do</span>
not satisfy the conventional restrictions. For example, the
the subroutine produces values of
      f(L1) = ( l1  <span class="highlight-number">2.5</span>  <span class="highlight-number">5.8</span>)
              (<span class="highlight-number">-0.3</span> <span class="highlight-number">1.5</span> <span class="highlight-number">-1.2</span>)
<span class="highlight-keyword">for</span> l1=<span class="highlight-number">3.3</span>,<span class="highlight-number">4.3</span>,...,<span class="highlight-number">8.3</span> but none of the symmetry properties of the <span class="highlight-number">3</span>j
symbol, <span class="highlight-keyword">set</span> forth <span class="highlight-keyword">on</span> page <span class="highlight-number">1056</span> of Messiah, <span class="highlight-keyword">is</span> satisfied.

The subroutine generates f(l1min), f(l1min<span class="highlight-number">+1</span>), ..., f(l1max)
<span class="highlight-keyword">where</span> l1min and l1max are defined above. The sequence f(l1) <span class="highlight-keyword">is</span>
generated by a three-term recurrence algorithm with scaling to
control overflow. Both backward and forward recurrence are used to
maintain numerical stability. The two recurrence sequences are
matched at an interior point and are normalized <span class="highlight-keyword">from</span> the unitary
property of <span class="highlight-number">3</span>j coefficients and Wigner's phase convention.

The algorithm <span class="highlight-keyword">is</span> suited to applications <span class="highlight-keyword">in</span> which large quantum
numbers arise, such <span class="highlight-keyword">as</span> <span class="highlight-keyword">in</span> molecular dynamics.

References:
-----------
 <span class="highlight-number">1</span>. Abramowitz, M., and Stegun, I. A., Eds., Handbook
    of Mathematical Functions with Formulas, Graphs
    and Mathematical Tables, NBS Applied Mathematics
    Series <span class="highlight-number">55</span>, June <span class="highlight-number">1964</span> and subsequent printings.
 <span class="highlight-number">2</span>. Messiah, Albert., Quantum Mechanics, Volume II,
    North-Holland Publishing Company, <span class="highlight-number">1963</span>.
 <span class="highlight-number">3</span>. Schulten, Klaus and Gordon, Roy G., Exact recursive
    evaluation of <span class="highlight-number">3</span>j and <span class="highlight-number">6</span>j coefficients <span class="highlight-keyword">for</span> quantum-
    mechanical coupling of angular momenta, J Math
    Phys, v <span class="highlight-number">16</span>, no. <span class="highlight-number">10</span>, October <span class="highlight-number">1975</span>, pp. <span class="highlight-number">1961</span>-<span class="highlight-number">1970</span>.
 <span class="highlight-number">4</span>. Schulten, Klaus and Gordon, Roy G., Semiclassical
    approximations to <span class="highlight-number">3</span>j  and <span class="highlight-number">6</span>j coefficients <span class="highlight-keyword">for</span>
    quantum-mechanical coupling of angular momenta,
    J Math Phys, v <span class="highlight-number">16</span>, no. <span class="highlight-number">10</span>, October <span class="highlight-number">1975</span>, pp. <span class="highlight-number">1971</span>-<span class="highlight-number">1988</span>.
 <span class="highlight-number">5</span>. Schulten, Klaus and Gordon, Roy G., Recursive
    evaluation of <span class="highlight-number">3</span>j and <span class="highlight-number">6</span>j coefficients, Computer
    Phys Comm, v <span class="highlight-number">11</span>, <span class="highlight-number">1976</span>, pp. <span class="highlight-number">269</span>-<span class="highlight-number">278</span>.
 <span class="highlight-number">6</span>. SLATEC library, category  C19,
    <span class="highlight-keyword">double</span> precision algorithm DRC3JJ.F
    Keywords: <span class="highlight-number">3</span>j coefficients, <span class="highlight-number">3</span>j symbols, Clebsch-Gordan coefficients,
              Racah coefficients, vector addition coefficients,
              Wigner coefficients
    Author:   Gordon, R. G., Harvard University
              Schulten, K., Max Planck Institute
    Revision history  (YYMMDD)
    <span class="highlight-number">750101</span>  DATE WRITTEN
    <span class="highlight-number">880515</span>  SLATEC prologue added by G. C. Nielson, NBS; parameters
            HUGE and TINY revised to depend <span class="highlight-keyword">on</span> D1MACH.
    <span class="highlight-number">891229</span>  Prologue description rewritten; other prologue sections
            revised; LMATCH (location of match point <span class="highlight-keyword">for</span> recurrences)
            removed <span class="highlight-keyword">from</span> argument list; argument errflag changed to serve
            only <span class="highlight-keyword">as</span> an error flag (previously, <span class="highlight-keyword">in</span> cases without error,
            it returned the number of scalings); number of error codes
            increased to provide more precise error information;
            program comments revised; SLATEC error handler calls
            introduced to enable printing of error messages to meet
            SLATEC standards. These changes were done by D. W. Lozier,
            M. A. McClain and J. M. Smith of the National Institute
            of Standards and Technology, formerly NBS.
    <span class="highlight-number">910415</span>  Mixed type expressions eliminated; variable C1 initialized;
            description of THRCOF expanded. These changes were done by
            D. W. Lozier.
 <span class="highlight-number">7</span>. Rewritting of the SLATEX algorithm <span class="highlight-keyword">in</span> C++ and adaption to the
    Matpack C++ Numerics and Graphics Library by Berndt M. Gammel
    <span class="highlight-keyword">in</span> June <span class="highlight-number">1997</span>.</pre></div></div></div></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('seeAlso')" onkeypress="SectionExpandCollapse_CheckKey('seeAlso', event)" tabindex="0"><img id="seeAlsoToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />See Also</span></div><div id="seeAlsoSection" class="collapsibleSection"><h4>Reference</h4><div><a href="T_Altaxo_Calc_VectorCoupling.htm">VectorCoupling Class</a></div><div><a href="N_Altaxo_Calc.htm">Altaxo.Calc Namespace</a></div></div></div></div><div id="PageFooter" class="pageFooter">Altaxo can be downloaded from <a href="https://sourceforge.net/projects/altaxo/files/Altaxo/">SourceForge</a>. Source code available on <a href="https://github.com/Altaxo/Altaxo">Github</a>.
<br /><a href="https://sourceforge.net/u/dlellinger/profile/">(C) Dr. Dirk Lellinger and all contributors to the source code 2002 - <script>document.write(new Date().getFullYear()); </script></a><div class="feedbackLink">Send comments on this topic to
        <a id="HT_MailLink" href="mailto:dlellinger%40users.sourceforge.net?Subject=Altaxo%20user%20manual%20and%20class%20reference">dlellinger@users.sourceforge.net</a></div>
        <script type="text/javascript">
        var HT_mailLink = document.getElementById("HT_MailLink");
        HT_mailLink.href += ": " + document.title + "\u0026body=" + encodeURIComponent("Your feedback is used to improve the documentation and the product. Your e-mail address will not be used for any other purpose and is disposed of after the issue you report is resolved. While working to resolve the issue that you report, you may be contacted via e-mail to get further details or clarification on the feedback you sent. After the issue you report has been addressed, you may receive an e-mail to let you know that your feedback has been addressed.");
        </script></div></body></html>